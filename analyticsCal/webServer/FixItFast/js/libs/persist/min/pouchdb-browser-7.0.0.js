!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.PouchDB=a()}}(function(){var a;return function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";function d(a){return function(){var b=arguments.length;if(b){for(var c=[],d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}return a.call(this,[])}}b.exports=d},{}],2:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if((b=arguments[1])instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners)&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace()),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){return this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],3:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||void 0===a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],5:[function(a,b,c){(function(c,d){"use strict";function e(a){return a&&"object"==typeof a&&"default"in a?a.default:a}function f(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer||"undefined"!=typeof Blob&&a instanceof Blob}function g(a){if("function"==typeof a.slice)return a.slice(0);var b=new ArrayBuffer(a.byteLength),c=new Uint8Array(b),d=new Uint8Array(a);return c.set(d),b}function h(a){if(a instanceof ArrayBuffer)return g(a);var b=a.size,c=a.type;return"function"==typeof a.slice?a.slice(0,b,c):a.webkitSlice(0,b,c)}function i(a){var b=Object.getPrototypeOf(a);if(null===b)return!0;var c=b.constructor;return"function"==typeof c&&c instanceof c&&Hd.call(c)==Id}function j(a){var b,c,d;if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){for(b=[],c=0,d=a.length;c<d;c++)b[c]=j(a[c]);return b}if(a instanceof Date)return a.toISOString();if(f(a))return h(a);if(!i(a))return a;b={};for(c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var e=j(a[c]);void 0!==e&&(b[c]=e)}return b}function k(a){var b=!1;return Ad(function(c){if(b)throw new Error("once called more than once");b=!0,a.apply(this,c)})}function l(a){return Ad(function(b){b=j(b);var c=this,d="function"==typeof b[b.length-1]&&b.pop(),e=new Promise(function(d,e){var f;try{var g=k(function(a,b){a?e(a):d(b)});b.push(g),f=a.apply(c,b),f&&"function"==typeof f.then&&d(f)}catch(a){e(a)}});return d&&e.then(function(a){d(null,a)},d),e})}function m(a,b,c){if(a.constructor.listeners("debug").length){for(var d=["api",a.name,b],e=0;e<c.length-1;e++)d.push(c[e]);a.constructor.emit("debug",d);var f=c[c.length-1];c[c.length-1]=function(c,d){var e=["api",a.name,b];e=e.concat(c?["error",c]:["success",d]),a.constructor.emit("debug",e),f(c,d)}}}function n(a,b){return l(Ad(function(c){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var d=this;return m(d,a,c),this.taskqueue.isReady?b.apply(this,c):new Promise(function(b,e){d.taskqueue.addTask(function(f){f?e(f):b(d[a].apply(d,c))})})}))}function o(a){return"$"+a}function p(a){return a.substring(1)}function q(){this._store={}}function r(a){if(this._store=new q,a&&Array.isArray(a))for(var b=0,c=a.length;b<c;b++)this.add(a[b])}function s(a,b){for(var c={},d=0,e=b.length;d<e;d++){var f=b[d];f in a&&(c[f]=a[f])}return c}function t(a){return a}function u(a){return[{ok:a}]}function v(a,b,c){function d(){var a=[];m.forEach(function(b){b.docs.forEach(function(c){a.push({id:b.id,docs:[c]})})}),c(null,{results:a})}function e(){++l===k&&d()}function f(a,b,c){m[a]={id:b,docs:c},e()}function g(){if(!(o>=n.length)){var a=Math.min(o+Md,n.length),b=n.slice(o,a);h(b,o),o+=b.length}}function h(c,d){c.forEach(function(c,e){var h=d+e,i=j.get(c),k=s(i[0],["atts_since","attachments"]);k.open_revs=i.map(function(a){return a.rev}),k.open_revs=k.open_revs.filter(t);var l=t;0===k.open_revs.length&&(delete k.open_revs,l=u),["revs","attachments","binary","ajax","latest"].forEach(function(a){a in b&&(k[a]=b[a])}),a.get(c,k,function(a,b){var d;d=a?[{error:a}]:l(b),f(h,c,d),g()})})}var i=b.docs,j=new Kd;i.forEach(function(a){j.has(a.id)?j.get(a.id).push(a):j.set(a.id,[a])});var k=j.size,l=0,m=new Array(k),n=[];j.forEach(function(a,b){n.push(b)});var o=0;g()}function w(){return Ld}function x(a){w()&&addEventListener("storage",function(b){a.emit(b.key)})}function y(){Cd.EventEmitter.call(this),this._listeners={},x(this)}function z(a){if("undefined"!=typeof console&&"function"==typeof console[a]){var b=Array.prototype.slice.call(arguments,1);console[a].apply(console,b)}}function A(a,b){return a=parseInt(a,10)||0,b=parseInt(b,10),b!==b||b<=a?b=(a||1)<<1:b+=1,b>6e5&&(a=3e5,b=6e5),~~((b-a)*Math.random()+a)}function B(a){var b=0;return a||(b=2e3),A(a,b)}function C(a,b){z("info","The above "+a+" is totally normal. "+b)}function D(a,b,c){Error.call(this,c),this.status=a,this.name=b,this.message=c,this.error=!0}function E(a,b){function c(b){for(var c in a)"function"!=typeof a[c]&&(this[c]=a[c]);void 0!==b&&(this.reason=b)}return c.prototype=D.prototype,new c(b)}function F(a){if("object"!=typeof a){var b=a;a=Vd,a.data=b}return"error"in a&&"conflict"===a.error&&(a.name="conflict",a.status=409),"name"in a||(a.name=a.error||"unknown"),"status"in a||(a.status=500),"message"in a||(a.message=a.message||a.reason),a}function G(a,b,c){try{return!a(b,c)}catch(a){var d="Filter function threw: "+a.toString();return E(Zd,d)}}function H(a){var b={},c=a.filter&&"function"==typeof a.filter;return b.query=a.query_params,function(d){d.doc||(d.doc={});var e=c&&G(a.filter,d.doc,b);if("object"==typeof e)return e;if(e)return!1;if(a.include_docs){if(!a.attachments)for(var f in d.doc._attachments)d.doc._attachments.hasOwnProperty(f)&&(d.doc._attachments[f].stub=!0)}else delete d.doc;return!0}}function I(a){for(var b=[],c=0,d=a.length;c<d;c++)b=b.concat(a[c]);return b}function J(a){var b;if(a?"string"!=typeof a?b=E(Sd):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=E(Ud)):b=E(Td),b)throw b}function K(a){return"boolean"==typeof a._remote?a._remote:"function"==typeof a.type&&(z("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===a.type())}function L(a,b){return"listenerCount"in a?a.listenerCount(b):Cd.EventEmitter.listenerCount(a,b)}function M(a){if(!a)return null;var b=a.split("/");return 2===b.length?b:1===b.length?[a,a]:null}function N(a){var b=M(a);return b?b.join("/"):null}function O(a){for(var b=fe.exec(a),c={},d=14;d--;){var e=ce[d],f=b[d]||"",g=-1!==["user","password"].indexOf(e);c[e]=g?decodeURIComponent(f):f}return c[de]={},c[ce[12]].replace(ee,function(a,b,d){b&&(c[de][b]=d)}),c}function P(a,b){var c=[],d=[];for(var e in b)b.hasOwnProperty(e)&&(c.push(e),d.push(b[e]));return c.push(a),Function.apply(null,c).apply(null,d)}function Q(a,b,c){return new Promise(function(d,e){a.get(b,function(f,g){if(f){if(404!==f.status)return e(f);g={}}var h=g._rev,i=c(g);if(!i)return d({updated:!1,rev:h});i._id=b,i._rev=h,d(R(a,i,c))})})}function R(a,b,c){return a.put(b).then(function(a){return{updated:!0,rev:a.rev}},function(d){if(409!==d.status)throw d;return Q(a,b._id,c)})}function S(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(f){if("TypeError"!==f.name)throw f;for(var c="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,d=new c,e=0;e<a.length;e+=1)d.append(a[e]);return d.getBlob(b.type)}}function T(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}function U(a,b){return S([T(a)],{type:b})}function V(a,b){return U(ge(a),b)}function W(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;e<d;e++)b+=String.fromCharCode(c[e]);return b}function X(a,b){var c=new FileReader,d="function"==typeof c.readAsBinaryString;c.onloadend=function(a){var c=a.target.result||"";if(d)return b(c);b(W(c))},d?c.readAsBinaryString(a):c.readAsArrayBuffer(a)}function Y(a,b){X(a,function(a){b(a)})}function Z(a,b){Y(a,function(a){b(he(a))})}function $(a,b){var c=new FileReader;c.onloadend=function(a){var c=a.target.result||new ArrayBuffer(0);b(c)},c.readAsArrayBuffer(a)}function _(a){return he(a)}function aa(a,b,c){return a.webkitSlice?a.webkitSlice(b,c):a.slice(b,c)}function ba(a,b,c,d,e){(c>0||d<b.size)&&(b=aa(b,c,d)),$(b,function(b){a.append(b),e()})}function ca(a,b,c,d,e){(c>0||d<b.length)&&(b=b.substring(c,d)),a.appendBinary(b),e()}function da(a,b){function c(){ie(e)}function d(){var a=k.end(!0),c=_(a);b(c),k.destroy()}function e(){var b=j*h,e=b+h;j++,j<i?l(k,a,b,e,c):l(k,a,b,e,d)}var f="string"==typeof a,g=f?a.length:a.size,h=Math.min(je,g),i=Math.ceil(g/h),j=0,k=f?new Ed:new Ed.ArrayBuffer,l=f?ca:ba;e()}function ea(a){return Ed.hash(a)}function fa(a,b){var c=j(a);return b?(delete c._rev_tree,ea(JSON.stringify(c))):Fd.v4().replace(/-/g,"").toLowerCase()}function ga(a){for(var b,c,d,e,f=a.rev_tree.slice();e=f.pop();){var g=e.ids,h=g[2],i=e.pos;if(h.length)for(var j=0,k=h.length;j<k;j++)f.push({pos:i+1,ids:h[j]});else{var l=!!g[1].deleted,m=g[0];b&&!(d!==l?d:c!==i?c<i:b<m)||(b=m,c=i,d=l)}}return c+"-"+b}function ha(a,b){for(var c,d=a.slice();c=d.pop();)for(var e=c.pos,f=c.ids,g=f[2],h=b(0===g.length,e,f[0],c.ctx,f[1]),i=0,j=g.length;i<j;i++)d.push({pos:e+1,ids:g[i],ctx:h})}function ia(a,b){return a.pos-b.pos}function ja(a){var b=[];ha(a,function(a,c,d,e,f){a&&b.push({rev:c+"-"+d,pos:c,opts:f})}),b.sort(ia).reverse();for(var c=0,d=b.length;c<d;c++)delete b[c].pos;return b}function ka(a){for(var b=ga(a),c=ja(a.rev_tree),d=[],e=0,f=c.length;e<f;e++){var g=c[e];g.rev===b||g.opts.deleted||d.push(g.rev)}return d}function la(a){var b=[];return ha(a.rev_tree,function(a,c,d,e,f){"available"!==f.status||a||(b.push(c+"-"+d),f.status="missing")}),b}function ma(a){for(var b,c=[],d=a.slice();b=d.pop();){var e=b.pos,f=b.ids,g=f[0],h=f[1],i=f[2],j=0===i.length,k=b.history?b.history.slice():[];k.push({id:g,opts:h}),j&&c.push({pos:e+1-k.length,ids:k});for(var l=0,m=i.length;l<m;l++)d.push({pos:e+1,ids:i[l],history:k})}return c.reverse()}function na(a,b){return a.pos-b.pos}function oa(a,b,c){for(var d,e=0,f=a.length;e<f;)d=e+f>>>1,c(a[d],b)<0?e=d+1:f=d;return e}function pa(a,b,c){var d=oa(a,b,c);a.splice(d,0,b)}function qa(a,b){for(var c,d,e=b,f=a.length;e<f;e++){var g=a[e],h=[g.id,g.opts,[]];d?(d[2].push(h),d=h):c=d=h}return c}function ra(a,b){return a[0]<b[0]?-1:1}function sa(a,b){for(var c=[{tree1:a,tree2:b}],d=!1;c.length>0;){var e=c.pop(),f=e.tree1,g=e.tree2;(f[1].status||g[1].status)&&(f[1].status="available"===f[1].status||"available"===g[1].status?"available":"missing");for(var h=0;h<g[2].length;h++)if(f[2][0]){for(var i=!1,j=0;j<f[2].length;j++)f[2][j][0]===g[2][h][0]&&(c.push({tree1:f[2][j],tree2:g[2][h]}),i=!0);i||(d="new_branch",pa(f[2],g[2][h],ra))}else d="new_leaf",f[2][0]=g[2][h]}return{conflicts:d,tree:a}}function ta(a,b,c){var d,e=[],f=!1,g=!1;if(!a.length)return{tree:[b],conflicts:"new_leaf"};for(var h=0,i=a.length;h<i;h++){var j=a[h];if(j.pos===b.pos&&j.ids[0]===b.ids[0])d=sa(j.ids,b.ids),e.push({pos:j.pos,ids:d.tree}),f=f||d.conflicts,g=!0;else if(!0!==c){var k=j.pos<b.pos?j:b,l=j.pos<b.pos?b:j,m=l.pos-k.pos,n=[],o=[];for(o.push({ids:k.ids,diff:m,parent:null,parentIdx:null});o.length>0;){var p=o.pop();if(0!==p.diff)for(var q=p.ids[2],r=0,s=q.length;r<s;r++)o.push({ids:q[r],diff:p.diff-1,parent:p.ids,parentIdx:r});else p.ids[0]===l.ids[0]&&n.push(p)}var t=n[0];t?(d=sa(t.ids,l.ids),t.parent[2][t.parentIdx]=d.tree,e.push({pos:k.pos,ids:k.ids}),f=f||d.conflicts,g=!0):e.push(j)}else e.push(j)}return g||e.push(b),e.sort(na),{tree:e,conflicts:f||"internal_node"}}function ua(a,b){for(var c,d,e=ma(a),f=0,g=e.length;f<g;f++){var h,i=e[f],j=i.ids;if(j.length>b){c||(c={});var k=j.length-b;h={pos:i.pos+k,ids:qa(j,k)};for(var l=0;l<k;l++){var m=i.pos+l+"-"+j[l].id;c[m]=!0}}else h={pos:i.pos,ids:qa(j,0)};d=d?ta(d,h,!0).tree:[h]}return c&&ha(d,function(a,b,d){delete c[b+"-"+d]}),{tree:d,revs:c?Object.keys(c):[]}}function va(a,b,c){var d=ta(a,b),e=ua(d.tree,c);return{tree:e.tree,stemmedRevs:e.revs,conflicts:d.conflicts}}function wa(a,b){for(var c,d=a.slice(),e=b.split("-"),f=parseInt(e[0],10),g=e[1];c=d.pop();){if(c.pos===f&&c.ids[0]===g)return!0;for(var h=c.ids[2],i=0,j=h.length;i<j;i++)d.push({pos:c.pos+1,ids:h[i]})}return!1}function xa(a){return a.ids}function ya(a,b){b||(b=ga(a));for(var c,d=b.substring(b.indexOf("-")+1),e=a.rev_tree.map(xa);c=e.pop();){if(c[0]===d)return!!c[1].deleted;e=e.concat(c[2])}}function za(a){return/^_local/.test(a)}function Aa(a,b){for(var c,d=b.rev_tree.slice();c=d.pop();){var e=c.pos,f=c.ids,g=f[0],h=f[1],i=f[2],j=0===i.length,k=c.history?c.history.slice():[];if(k.push({id:g,pos:e,opts:h}),j)for(var l=0,m=k.length;l<m;l++){var n=k[l],o=n.pos+"-"+n.id;if(o===a)return e+"-"+g}for(var p=0,q=i.length;p<q;p++)d.push({pos:e+1,ids:i[p],history:k})}throw new Error("Unable to resolve latest revision for id "+b.id+", rev "+a)}function Ba(a,b,c,d){try{a.emit("change",b,c,d)}catch(a){z("error",'Error in .on("change", function):',a)}}function Ca(a,b,c){function d(){e.cancel()}Cd.EventEmitter.call(this);var e=this;this.db=a,b=b?j(b):{};var f=b.complete=k(function(b,c){b?L(e,"error")>0&&e.emit("error",b):e.emit("complete",c),e.removeAllListeners(),a.removeListener("destroyed",d)});c&&(e.on("complete",function(a){c(null,a)}),e.on("error",c)),a.once("destroyed",d),b.onChange=function(a,b,c){e.isCancelled||Ba(e,a,b,c)};var g=new Promise(function(a,c){b.complete=function(b,d){b?c(b):a(d)}});e.once("cancel",function(){a.removeListener("destroyed",d),b.complete(null,{status:"cancelled"})}),this.then=g.then.bind(g),this.catch=g.catch.bind(g),this.then(function(a){f(null,a)},f),a.taskqueue.isReady?e.validateChanges(b):a.taskqueue.addTask(function(a){a?b.complete(a):e.isCancelled?e.emit("cancel"):e.validateChanges(b)})}function Da(a,b,c){var d=[{rev:a._rev}];"all_docs"===c.style&&(d=ja(b.rev_tree).map(function(a){return{rev:a.rev}}));var e={id:b.id,changes:d,doc:a};return ya(b,a._rev)&&(e.deleted=!0),c.conflicts&&(e.doc._conflicts=ka(b),e.doc._conflicts.length||delete e.doc._conflicts),e}function Ea(a,b){return a<b?-1:a>b?1:0}function Fa(a,b){return function(c,d){c||d[0]&&d[0].error?(c=c||d[0],c.docId=b,a(c)):a(null,d.length?d[0]:d)}}function Ga(a){for(var b=0;b<a.length;b++){var c=a[b];if(c._deleted)delete c._attachments;else if(c._attachments)for(var d=Object.keys(c._attachments),e=0;e<d.length;e++){var f=d[e];c._attachments[f]=s(c._attachments[f],["data","digest","content_type","length","revpos","stub"])}}}function Ha(a,b){var c=Ea(a._id,b._id);return 0!==c?c:Ea(a._revisions?a._revisions.start:0,b._revisions?b._revisions.start:0)}function Ia(a){var b={},c=[];return ha(a,function(a,d,e,f){var g=d+"-"+e;return a&&(b[g]=0),void 0!==f&&c.push({from:f,to:g}),g}),c.reverse(),c.forEach(function(a){void 0===b[a.from]?b[a.from]=1+b[a.to]:b[a.from]=Math.min(b[a.from],1+b[a.to])}),b}function Ja(a){var b="limit"in a?a.keys.slice(a.skip,a.limit+a.skip):a.skip>0?a.keys.slice(a.skip):a.keys;a.keys=b,a.skip=0,delete a.limit,a.descending&&(b.reverse(),a.descending=!1)}function Ka(a){var b=a._compactionQueue[0],c=b.opts,d=b.callback;a.get("_local/compaction").catch(function(){return!1}).then(function(b){b&&b.last_seq&&(c.last_seq=b.last_seq),a._compact(c,function(b,c){b?d(b):d(null,c),Bd(function(){a._compactionQueue.shift(),a._compactionQueue.length&&Ka(a)})})})}function La(a){return"_"===a.charAt(0)&&a+" is not a valid attachment name, attachment names cannot start with '_'"}function Ma(){Cd.EventEmitter.call(this);for(var a in Ma.prototype)"function"==typeof this[a]&&(this[a]=this[a].bind(this))}function Na(){this.isReady=!1,this.failed=!1,this.queue=[]}function Oa(a,b){var c=a.match(/([a-z-]*):\/\/(.*)/);if(c)return{name:/https?/.test(c[1])?c[1]+"://"+c[2]:c[2],adapter:c[1]};var d=Qa.adapters,e=Qa.preferredAdapters,f=Qa.prefix,g=b.adapter;if(!g)for(var h=0;h<e.length;++h){g=e[h];{if(!("idb"===g&&"websql"in d&&w()&&localStorage["_pouch__websqldb_"+f+a]))break;z("log",'PouchDB is downgrading "'+a+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.')}}var i=d[g];return{name:i&&"use_prefix"in i&&!i.use_prefix?a:f+a,adapter:g}}function Pa(a){function b(b){a.removeListener("closed",c),b||a.constructor.emit("destroyed",a.name)}function c(){a.removeListener("destroyed",b),a.constructor.emit("unref",a)}a.once("destroyed",b),a.once("closed",c),a.constructor.emit("ref",a)}function Qa(a,b){if(!(this instanceof Qa))return new Qa(a,b);var c=this;if(b=b||{},a&&"object"==typeof a&&(b=a,a=b.name,delete b.name),void 0===b.deterministic_revs&&(b.deterministic_revs=!0),this.__opts=b=j(b),c.auto_compaction=b.auto_compaction,c.prefix=Qa.prefix,"string"!=typeof a)throw new Error("Missing/invalid DB name");var d=(b.prefix||"")+a,e=Oa(d,b);if(b.name=e.name,b.adapter=b.adapter||e.adapter,c.name=a,c._adapter=b.adapter,Qa.emit("debug",["adapter","Picked adapter: ",b.adapter]),!Qa.adapters[b.adapter]||!Qa.adapters[b.adapter].valid())throw new Error("Invalid Adapter: "+b.adapter);Ma.call(c),c.taskqueue=new Na,c.adapter=b.adapter,Qa.adapters[b.adapter].call(c,b,function(a){if(a)return c.taskqueue.fail(a);Pa(c),c.emit("created",c),Qa.emit("created",c.name),c.taskqueue.ready(c)})}function Ra(a,b){for(var c=a,d=0,e=b.length;d<e;d++){if(!(c=c[b[d]]))break}return c}function Sa(a,b){return a<b?-1:a>b?1:0}function Ta(a){for(var b=[],c="",d=0,e=a.length;d<e;d++){var f=a[d];"."===f?d>0&&"\\"===a[d-1]?c=c.substring(0,c.length-1)+".":(b.push(c),c=""):c+=f}return b.push(c),b}function Ua(a){return pe.indexOf(a)>-1}function Va(a){return Object.keys(a)[0]}function Wa(a){return a[Va(a)]}function Xa(a){var b={};return a.forEach(function(a){Object.keys(a).forEach(function(c){var d=a[c];if("object"!=typeof d&&(d={$eq:d}),Ua(c))d instanceof Array?b[c]=d.map(function(a){return Xa([a])}):b[c]=Xa([d]);else{var e=b[c]=b[c]||{};Object.keys(d).forEach(function(a){var b=d[a];return"$gt"===a||"$gte"===a?Ya(a,b,e):"$lt"===a||"$lte"===a?Za(a,b,e):"$ne"===a?$a(b,e):"$eq"===a?_a(b,e):void(e[a]=b)})}})}),b}function Ya(a,b,c){void 0===c.$eq&&(void 0!==c.$gte?"$gte"===a?b>c.$gte&&(c.$gte=b):b>=c.$gte&&(delete c.$gte,c.$gt=b):void 0!==c.$gt?"$gte"===a?b>c.$gt&&(delete c.$gt,c.$gte=b):b>c.$gt&&(c.$gt=b):c[a]=b)}function Za(a,b,c){void 0===c.$eq&&(void 0!==c.$lte?"$lte"===a?b<c.$lte&&(c.$lte=b):b<=c.$lte&&(delete c.$lte,c.$lt=b):void 0!==c.$lt?"$lte"===a?b<c.$lt&&(delete c.$lt,c.$lte=b):b<c.$lt&&(c.$lt=b):c[a]=b)}function $a(a,b){"$ne"in b?b.$ne.push(a):b.$ne=[a]}function _a(a,b){delete b.$gt,delete b.$gte,delete b.$lt,delete b.$lte,delete b.$ne,b.$eq=a}function ab(a){var b=j(a),c=!1;"$and"in b&&(b=Xa(b.$and),c=!0),["$or","$nor"].forEach(function(a){a in b&&b[a].forEach(function(a){for(var b=Object.keys(a),c=0;c<b.length;c++){var d=b[c],e=a[d];"object"==typeof e&&null!==e||(a[d]={$eq:e})}})}),"$not"in b&&(b.$not=Xa([b.$not]));for(var d=Object.keys(b),e=0;e<d.length;e++){var f=d[e],g=b[f];"object"!=typeof g||null===g?g={$eq:g}:"$ne"in g&&!c&&(g.$ne=[g.$ne]),b[f]=g}return b}function bb(a,b,c){for(var d="",e=c-a.length;d.length<e;)d+=b;return d}function cb(a,b,c){return bb(a,b,c)+a}function db(a,b){if(a===b)return 0;a=eb(a),b=eb(b);var c=nb(a),d=nb(b);if(c-d!=0)return c-d;switch(typeof a){case"number":return a-b;case"boolean":return a<b?-1:1;case"string":return lb(a,b)}return Array.isArray(a)?kb(a,b):mb(a,b)}function eb(a){switch(typeof a){case"undefined":return null;case"number":return a===1/0||a===-1/0||isNaN(a)?null:a;case"object":var b=a;if(Array.isArray(a)){var c=a.length;a=new Array(c);for(var d=0;d<c;d++)a[d]=eb(b[d])}else{if(a instanceof Date)return a.toJSON();if(null!==a){a={};for(var e in b)if(b.hasOwnProperty(e)){var f=b[e];void 0!==f&&(a[e]=eb(f))}}}}return a}function fb(a){if(null!==a)switch(typeof a){case"boolean":return a?1:0;case"number":return ob(a);case"string":return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var b=Array.isArray(a),c=b?a:Object.keys(a),d=-1,e=c.length,f="";if(b)for(;++d<e;)f+=gb(c[d]);else for(;++d<e;){var g=c[d];f+=gb(g)+gb(a[g])}return f}return""}function gb(a){return a=eb(a),nb(a)+se+fb(a)+"\0"}function hb(a,b){var c,d=b;if("1"===a[b])c=0,b++;else{var e="0"===a[b];b++;var f="",g=a.substring(b,b+re),h=parseInt(g,10)+qe;for(e&&(h=-h),b+=re;;){var i=a[b];if("\0"===i)break;f+=i,b++}f=f.split("."),c=1===f.length?parseInt(f,10):parseFloat(f[0]+"."+f[1]),e&&(c-=10),0!==h&&(c=parseFloat(c+"e"+h))}return{num:c,length:b-d}}function ib(a,b){var c=a.pop();if(b.length){var d=b[b.length-1];c===d.element&&(b.pop(),d=b[b.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(c);else if(f===a.length-2){var g=a.pop();e[g]=c}else a.push(c)}}function jb(a){for(var b=[],c=[],d=0;;){var e=a[d++];if("\0"!==e)switch(e){case"1":b.push(null);break;case"2":b.push("1"===a[d]),d++;break;case"3":var f=hb(a,d);b.push(f.num),d+=f.length;break;case"4":for(var g="";;){var h=a[d];if("\0"===h)break;g+=h,d++}g=g.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),b.push(g);break;case"5":var i={element:[],index:b.length};b.push(i.element),c.push(i);break;case"6":var j={element:{},index:b.length};b.push(j.element),c.push(j);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+e)}else{if(1===b.length)return b.pop();ib(b,c)}}}function kb(a,b){for(var c=Math.min(a.length,b.length),d=0;d<c;d++){var e=db(a[d],b[d]);if(0!==e)return e}return a.length===b.length?0:a.length>b.length?1:-1}function lb(a,b){return a===b?0:a>b?1:-1}function mb(a,b){for(var c=Object.keys(a),d=Object.keys(b),e=Math.min(c.length,d.length),f=0;f<e;f++){var g=db(c[f],d[f]);if(0!==g)return g;if(0!==(g=db(a[c[f]],b[d[f]])))return g}return c.length===d.length?0:c.length>d.length?1:-1}function nb(a){var b=["boolean","number","string","object"],c=b.indexOf(typeof a);return~c?null===a?1:Array.isArray(a)?5:c<3?c+2:c+3:Array.isArray(a)?5:void 0}function ob(a){if(0===a)return"1";var b=a.toExponential().split(/e\+?/),c=parseInt(b[1],10),d=a<0,e=d?"0":"2",f=(d?-c:c)-qe,g=cb(f.toString(),"0",re);e+=se+g;var h=Math.abs(parseFloat(b[0]));d&&(h=10-h);var i=h.toFixed(20);return i=i.replace(/\.?0+$/,""),e+=se+i}function pb(a){function b(b){return a.map(function(a){var c=Va(a),d=Ta(c);return Ra(b,d)})}return function(a,c){var d=b(a.doc),e=b(c.doc),f=db(d,e);return 0!==f?f:Sa(a.doc._id,c.doc._id)}}function qb(a,b,c){if(a=a.filter(function(a){return rb(a.doc,b.selector,c)}),b.sort){var d=pb(b.sort);a=a.sort(d),"string"!=typeof b.sort[0]&&"desc"===Wa(b.sort[0])&&(a=a.reverse())}if("limit"in b||"skip"in b){var e=b.skip||0,f=("limit"in b?b.limit:a.length)+e;a=a.slice(e,f)}return a}function rb(a,b,c){return c.every(function(c){var d=b[c],e=Ta(c),f=Ra(a,e);return Ua(c)?tb(c,d,a):sb(d,a,e,f)})}function sb(a,b,c,d){return!a||Object.keys(a).every(function(e){var f=a[e];return ub(e,b,f,c,d)})}function tb(a,b,c){return"$or"===a?b.some(function(a){return rb(c,a,Object.keys(a))}):"$not"===a?!rb(c,b,Object.keys(b)):!b.find(function(a){return rb(c,a,Object.keys(a))})}function ub(a,b,c,d,e){if(!te[a])throw new Error('unknown operator "'+a+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return te[a](b,c,d,e)}function vb(a){return void 0!==a&&null!==a}function wb(a){return void 0!==a}function xb(a,b){var c=b[0],d=b[1];if(0===c)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(c,10)!==c)throw new Error("Divisor is not an integer");if(parseInt(d,10)!==d)throw new Error("Modulus is not an integer");return parseInt(a,10)===a&&a%c===d}function yb(a,b){return b.some(function(b){return a instanceof Array?a.indexOf(b)>-1:a===b})}function zb(a,b){return b.every(function(b){return a.indexOf(b)>-1})}function Ab(a,b){return a.length===b}function Bb(a,b){return new RegExp(b).test(a)}function Cb(a,b){switch(b){case"null":return null===a;case"boolean":return"boolean"==typeof a;case"number":return"number"==typeof a;case"string":return"string"==typeof a;case"array":return a instanceof Array;case"object":return"[object Object]"==={}.toString.call(a)}throw new Error(b+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}function Db(a,b){if("object"!=typeof b)throw new Error("Selector error: expected a JSON object");b=ab(b);var c={doc:a},d=qb([c],{selector:b},Object.keys(b));return d&&1===d.length}function Eb(a){return P('"use strict";\nreturn '+a+";",{})}function Fb(a){return P(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+a+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}function Gb(a,b){if(a.selector&&a.filter&&"_selector"!==a.filter){var c="string"==typeof a.filter?a.filter:"function";return b(new Error('selector invalid for filter "'+c+'"'))}b()}function Hb(a){a.view&&!a.filter&&(a.filter="_view"),a.selector&&!a.filter&&(a.filter="_selector"),a.filter&&"string"==typeof a.filter&&("_view"===a.filter?a.view=N(a.view):a.filter=N(a.filter))}function Ib(a,b){return b.filter&&"string"==typeof b.filter&&!b.doc_ids&&!K(a.db)}function Jb(a,b){var c=b.complete;if("_view"===b.filter){if(!b.view||"string"!=typeof b.view){var d=E(Zd,"`view` filter parameter not found or invalid.");return c(d)}var e=M(b.view);a.db.get("_design/"+e[0],function(d,f){if(a.isCancelled)return c(null,{status:"cancelled"});if(d)return c(F(d));var g=f&&f.views&&f.views[e[1]]&&f.views[e[1]].map;if(!g)return c(E(Qd,f.views?"missing json key: "+e[1]:"missing json key: views"));b.filter=Fb(g),a.doChanges(b)})}else if(b.selector)b.filter=function(a){return Db(a,b.selector)},a.doChanges(b);else{var f=M(b.filter);a.db.get("_design/"+f[0],function(d,e){if(a.isCancelled)return c(null,{status:"cancelled"});if(d)return c(F(d));var g=e&&e.filters&&e.filters[f[1]];if(!g)return c(E(Qd,e&&e.filters?"missing json key: "+f[1]:"missing json key: filters"));b.filter=Eb(g),a.doChanges(b)})}}function Kb(a){a._changesFilterPlugin={validate:Gb,normalize:Hb,shouldFilter:Ib,filter:Jb}}function Lb(a){return a.reduce(function(a,b){return a[b]=!0,a},{})}function Mb(a){if(!/^\d+-./.test(a))return E(ae);var b=a.indexOf("-"),c=a.substring(0,b),d=a.substring(b+1);return{prefix:parseInt(c,10),id:d}}function Nb(a,b){for(var c=a.start-a.ids.length+1,d=a.ids,e=[d[0],b,[]],f=1,g=d.length;f<g;f++)e=[d[f],{status:"missing"},[e]];return[{pos:c,ids:e}]}function Ob(a,b,c){c||(c={deterministic_revs:!0});var d,e,f,g={status:"available"};if(a._deleted&&(g.deleted=!0),b)if(a._id||(a._id=ke()),e=fa(a,c.deterministic_revs),a._rev){if(f=Mb(a._rev),f.error)return f;a._rev_tree=[{pos:f.prefix,ids:[f.id,{status:"missing"},[[e,g,[]]]]}],d=f.prefix+1}else a._rev_tree=[{pos:1,ids:[e,g,[]]}],d=1;else if(a._revisions&&(a._rev_tree=Nb(a._revisions,g),d=a._revisions.start,e=a._revisions.ids[0]),!a._rev_tree){if(f=Mb(a._rev),f.error)return f;d=f.prefix,e=f.id,a._rev_tree=[{pos:d,ids:[e,g,[]]}]}J(a._id),a._rev=d+"-"+e;var h={metadata:{},data:{}};for(var i in a)if(Object.prototype.hasOwnProperty.call(a,i)){var j="_"===i[0];if(j&&!ve[i]){var k=E(Yd,i)
;throw k.message=Yd.message+": "+i,k}j&&!we[i]?h.metadata[i.slice(1)]=a[i]:h.data[i]=a[i]}return h}function Pb(a){try{return ge(a)}catch(a){var b=E(Wd,"Attachment is not a valid base64 string");return{error:b}}}function Qb(a,b,c){var d=Pb(a.data);if(d.error)return c(d.error);a.length=d.length,a.data="blob"===b?U(d,a.content_type):"base64"===b?he(d):d,da(d,function(b){a.digest="md5-"+b,c()})}function Rb(a,b,c){da(a.data,function(d){a.digest="md5-"+d,a.length=a.data.size||a.data.length||0,"binary"===b?Y(a.data,function(b){a.data=b,c()}):"base64"===b?Z(a.data,function(b){a.data=b,c()}):c()})}function Sb(a,b,c){if(a.stub)return c();"string"==typeof a.data?Qb(a,b,c):Rb(a,b,c)}function Tb(a,b,c){function d(){f++,a.length===f&&(e?c(e):c())}if(!a.length)return c();var e,f=0;a.forEach(function(a){function c(a){e=a,++g===f.length&&d()}var f=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],g=0;if(!f.length)return d();for(var h in a.data._attachments)a.data._attachments.hasOwnProperty(h)&&Sb(a.data._attachments[h],b,c)})}function Ub(a,b,c,d,e,f,g,h){if(wa(b.rev_tree,c.metadata.rev)&&!h)return d[e]=c,f();var i=b.winningRev||ga(b),j="deleted"in b?b.deleted:ya(b,i),k="deleted"in c.metadata?c.metadata.deleted:ya(c.metadata),l=/^1-/.test(c.metadata.rev);if(j&&!k&&h&&l){var m=c.data;m._rev=i,m._id=c.metadata.id,c=Ob(m,h)}var n=va(b.rev_tree,c.metadata.rev_tree[0],a);if(h&&(j&&k&&"new_leaf"!==n.conflicts||!j&&"new_leaf"!==n.conflicts||j&&!k&&"new_branch"===n.conflicts)){var o=E(Rd);return d[e]=o,f()}var p=c.metadata.rev;c.metadata.rev_tree=n.tree,c.stemmedRevs=n.stemmedRevs||[],b.rev_map&&(c.metadata.rev_map=b.rev_map);var q,r=ga(c.metadata),s=ya(c.metadata,r),t=j===s?0:j<s?-1:1;q=p===r?s:ya(c.metadata,p),g(c,r,s,q,!0,t,e,f)}function Vb(a){return"missing"===a.metadata.rev_tree[0].ids[1].status}function Wb(a,b,c,d,e,f,g,h,i){function j(a,b,c){var d=ga(a.metadata),e=ya(a.metadata,d);if("was_delete"in h&&e)return f[b]=E(Qd,"deleted"),c();if(l&&Vb(a)){var i=E(Rd);return f[b]=i,c()}g(a,d,e,e,!1,e?0:1,b,c)}function k(){++n===o&&i&&i()}a=a||1e3;var l=h.new_edits,m=new Kd,n=0,o=b.length;b.forEach(function(a,b){if(a._id&&za(a._id)){var d=a._deleted?"_removeLocal":"_putLocal";return void c[d](a,{ctx:e},function(a,c){f[b]=a||c,k()})}var g=a.metadata.id;m.has(g)?(o--,m.get(g).push([a,b])):m.set(g,[[a,b]])}),m.forEach(function(b,c){function e(){++i<b.length?h():k()}function h(){var h=b[i],k=h[0],m=h[1];if(d.has(c))Ub(a,d.get(c),k,f,m,e,g,l);else{var n=va([],k.metadata.rev_tree[0],a);k.metadata.rev_tree=n.tree,k.stemmedRevs=n.stemmedRevs||[],j(k,m,e)}}var i=0;h()})}function Xb(a){try{return JSON.parse(a)}catch(b){return Gd.parse(a)}}function Yb(a){try{return JSON.stringify(a)}catch(b){return Gd.stringify(a)}}function Zb(a){return function(b){var c="unknown_error";b.target&&b.target.error&&(c=b.target.error.name||b.target.error.message),a(E(_d,c,b.type))}}function $b(a,b,c){return{data:Yb(a),winningRev:b,deletedOrLocal:c?"1":"0",seq:a.seq,id:a.id}}function _b(a){if(!a)return null;var b=Xb(a.data);return b.winningRev=a.winningRev,b.deleted="1"===a.deletedOrLocal,b.seq=a.seq,b}function ac(a){if(!a)return a;var b=a._doc_id_rev.lastIndexOf(":");return a._id=a._doc_id_rev.substring(0,b-1),a._rev=a._doc_id_rev.substring(b+1),delete a._doc_id_rev,a}function bc(a,b,c,d){c?d(a?"string"!=typeof a?a:V(a,b):S([""],{type:b})):a?"string"!=typeof a?X(a,function(a){d(he(a))}):d(a):d("")}function cc(a,b,c,d){function e(){++h===g.length&&d&&d()}function f(a,b){var d=a._attachments[b],f=d.digest;c.objectStore(Ae).get(f).onsuccess=function(a){d.body=a.target.result.body,e()}}var g=Object.keys(a._attachments||{});if(!g.length)return d&&d();var h=0;g.forEach(function(c){b.attachments&&b.include_docs?f(a,c):(a._attachments[c].stub=!0,e())})}function dc(a,b){return Promise.all(a.map(function(a){if(a.doc&&a.doc._attachments){var c=Object.keys(a.doc._attachments);return Promise.all(c.map(function(c){var d=a.doc._attachments[c];if("body"in d){var e=d.body,f=d.content_type;return new Promise(function(g){bc(e,f,b,function(b){a.doc._attachments[c]=Od(s(d,["digest","content_type"]),{data:b}),g()})})}}))}}))}function ec(a,b,c){function d(){--j||e()}function e(){f.length&&f.forEach(function(a){i.index("digestSeq").count(IDBKeyRange.bound(a+"::",a+"::￿",!1,!1)).onsuccess=function(b){b.target.result||h.delete(a)}})}var f=[],g=c.objectStore(ze),h=c.objectStore(Ae),i=c.objectStore(Be),j=a.length;a.forEach(function(a){var c=g.index("_doc_id_rev"),e=b+"::"+a;c.getKey(e).onsuccess=function(a){var b=a.target.result;if("number"!=typeof b)return d();g.delete(b),i.index("seq").openCursor(IDBKeyRange.only(b)).onsuccess=function(a){var b=a.target.result;if(b){var c=b.value.digestSeq.split("::")[0];f.push(c),i.delete(b.primaryKey),b.continue()}else d()}}})}function fc(a,b,c){try{return{txn:a.transaction(b,c)}}catch(a){return{error:a}}}function gc(a,b,c,d,e,f){function g(){var a=[ye,ze,Ae,De,Be,Ce],b=fc(e,a,"readwrite");if(b.error)return f(b.error);t=b.txn,t.onabort=Zb(f),t.ontimeout=Zb(f),t.oncomplete=l,u=t.objectStore(ye),v=t.objectStore(ze),w=t.objectStore(Ae),x=t.objectStore(Be),y=t.objectStore(Ce),y.get(Ce).onsuccess=function(a){A=a.target.result,j()},n(function(a){if(a)return K=!0,f(a);k()})}function h(){G=!0,j()}function i(){Wb(a.revs_limit,B,d,J,t,I,o,c,h)}function j(){A&&G&&(A.docCount+=H,y.put(A))}function k(){function a(){++c===B.length&&i()}function b(b){var c=_b(b.target.result);c&&J.set(c.id,c),a()}if(B.length)for(var c=0,d=0,e=B.length;d<e;d++){var f=B[d];if(f._id&&za(f._id))a();else{var g=u.get(f.metadata.id);g.onsuccess=b}}}function l(){K||(Fe.notify(d._meta.name),f(null,I))}function m(a,b){w.get(a).onsuccess=function(c){if(c.target.result)b();else{var d=E(be,"unknown stub attachment with digest "+a);d.status=412,b(d)}}}function n(a){function b(){++e===c.length&&a(d)}var c=[];if(B.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(b){var d=a.data._attachments[b];d.stub&&c.push(d.digest)})}),!c.length)return a();var d,e=0;c.forEach(function(a){m(a,function(a){a&&!d&&(d=a),b()})})}function o(a,b,c,d,e,f,g,h){a.metadata.winningRev=b,a.metadata.deleted=c;var i=a.data;if(i._id=a.metadata.id,i._rev=a.metadata.rev,d&&(i._deleted=!0),i._attachments&&Object.keys(i._attachments).length)return q(a,b,c,e,g,h);H+=f,j(),p(a,b,c,e,g,h)}function p(a,b,c,e,f,g){function h(f){var g=a.stemmedRevs||[];e&&d.auto_compaction&&(g=g.concat(la(a.metadata))),g&&g.length&&ec(g,a.metadata.id,t),l.seq=f.target.result;var h=$b(l,b,c);u.put(h).onsuccess=j}function i(a){a.preventDefault(),a.stopPropagation(),v.index("_doc_id_rev").getKey(k._doc_id_rev).onsuccess=function(a){v.put(k,a.target.result).onsuccess=h}}function j(){I[f]={ok:!0,id:l.id,rev:l.rev},J.set(a.metadata.id,a.metadata),r(a,l.seq,g)}var k=a.data,l=a.metadata;k._doc_id_rev=l.id+"::"+l.rev,delete k._id,delete k._rev;var m=v.put(k);m.onsuccess=h,m.onerror=i}function q(a,b,c,d,e,f){function g(){j===k.length&&p(a,b,c,d,e,f)}function h(){j++,g()}var i=a.data,j=0,k=Object.keys(i._attachments);k.forEach(function(c){var d=a.data._attachments[c];if(d.stub)j++,g();else{var e=d.data;delete d.data,d.revpos=parseInt(b,10);s(d.digest,e,h)}})}function r(a,b,c){function d(){++e===f.length&&c()}var e=0,f=Object.keys(a.data._attachments||{});if(!f.length)return c();for(var g=0;g<f.length;g++)!function(c){var e=a.data._attachments[c].digest,f=x.put({seq:b,digestSeq:e+"::"+b});f.onsuccess=d,f.onerror=function(a){a.preventDefault(),a.stopPropagation(),d()}}(f[g])}function s(a,b,c){w.count(a).onsuccess=function(d){if(d.target.result)return c();var e={digest:a,body:b};w.put(e).onsuccess=c}}for(var t,u,v,w,x,y,z,A,B=b.docs,C=0,D=B.length;C<D;C++){var F=B[C];F._id&&za(F._id)||(F=B[C]=Ob(F,c.new_edits,a),F.error&&!z&&(z=F))}if(z)return f(z);var G=!1,H=0,I=new Array(B.length),J=new Kd,K=!1,L=d._meta.blobSupport?"blob":"base64";Tb(B,L,function(a){if(a)return f(a);g()})}function hc(a,b,c,d,e){function f(a){k=a.target.result,j&&e(j,k,l)}function g(a){j=a.target.result,k&&e(j,k,l)}function h(){if(!j.length)return e();var c,h=j[j.length-1];if(b&&b.upper)try{c=IDBKeyRange.bound(h,b.upper,!0,b.upperOpen)}catch(a){if("DataError"===a.name&&0===a.code)return e()}else c=IDBKeyRange.lowerBound(h,!0);b=c,j=null,k=null,a.getAll(b,d).onsuccess=f,a.getAllKeys(b,d).onsuccess=g}function i(a){var b=a.target.result;if(!b)return e();e([b.key],[b.value],b)}-1===d&&(d=1e3);var j,k,l,m="function"==typeof a.getAll&&"function"==typeof a.getAllKeys&&d>1&&!c;m?(l={continue:h},a.getAll(b,d).onsuccess=f,a.getAllKeys(b,d).onsuccess=g):c?a.openCursor(b,"prev").onsuccess=i:a.openCursor(b).onsuccess=i}function ic(a,b,c){function d(a){var b=a.target.result;b?(e.push(b.value),b.continue()):c({target:{result:e}})}if("function"==typeof a.getAll)return void(a.getAll(b).onsuccess=c);var e=[];a.openCursor(b).onsuccess=d}function jc(a,b,c){var d=new Array(a.length),e=0;a.forEach(function(f,g){b.get(f).onsuccess=function(b){b.target.result?d[g]=b.target.result:d[g]={key:f,error:"not_found"},++e===a.length&&c(a,d,{})}})}function kc(a,b,c,d,e){try{if(a&&b)return e?IDBKeyRange.bound(b,a,!c,!1):IDBKeyRange.bound(a,b,!1,!c);if(a)return e?IDBKeyRange.upperBound(a):IDBKeyRange.lowerBound(a);if(b)return e?IDBKeyRange.lowerBound(b,!c):IDBKeyRange.upperBound(b,!c);if(d)return IDBKeyRange.only(d)}catch(a){return{error:a}}return null}function lc(a,b,c){function d(b,c,d){var e=b.id+"::"+d;B.get(e).onsuccess=function(d){if(c.doc=ac(d.target.result)||{},a.conflicts){var e=ka(b);e.length&&(c.doc._conflicts=e)}cc(c.doc,a,v)}}function e(b,c){var e={id:c.id,key:c.id,value:{rev:b}};c.deleted?p&&(C.push(e),e.value.deleted=!0,e.doc=null):q--<=0&&(C.push(e),a.include_docs&&d(c,e,b))}function f(a){for(var b=0,c=a.length;b<c&&C.length!==r;b++){var d=a[b];if(d.error&&p)C.push(d);else{var f=_b(d);e(f.winningRev,f)}}}function g(a,b,c){c&&(f(b),C.length<r&&c.continue())}function h(b){var c=b.target.result;a.descending&&(c=c.reverse()),f(c)}function i(){var b={total_rows:w,offset:a.skip,rows:C};a.update_seq&&void 0!==x&&(b.update_seq=x),c(null,b)}function j(){a.attachments?dc(C,a.binary).then(i):i()}var k,l,m="startkey"in a&&a.startkey,n="endkey"in a&&a.endkey,o="key"in a&&a.key,p="keys"in a&&a.keys,q=a.skip||0,r="number"==typeof a.limit?a.limit:-1,s=!1!==a.inclusive_end;if(!p&&(k=kc(m,n,s,o,a.descending),(l=k&&k.error)&&("DataError"!==l.name||0!==l.code)))return c(E(_d,l.name,l.message));var t=[ye,ze,Ce];a.attachments&&t.push(Ae);var u=fc(b,t,"readonly");if(u.error)return c(u.error);var v=u.txn;v.oncomplete=j,v.onabort=Zb(c);var w,x,y=v.objectStore(ye),z=v.objectStore(ze),A=v.objectStore(Ce),B=z.index("_doc_id_rev"),C=[];return A.get(Ce).onsuccess=function(a){w=a.target.result.docCount},a.update_seq&&function(a,b){function c(a){var c=a.target.result,d=void 0;return c&&c.key&&(d=c.key),b({target:{result:[d]}})}a.openCursor(null,"prev").onsuccess=c}(z,function(a){a.target.result&&a.target.result.length>0&&(x=a.target.result[0])}),l||0===r?void 0:p?jc(a.keys,y,g):-1===r?ic(y,k,h):void hc(y,k,a.descending,r+q,g)}function mc(a){return new Promise(function(b){var c=S([""]),d=a.objectStore(Ee).put(c,"key");d.onsuccess=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);b(c||!a||parseInt(a[1],10)>=43)},d.onerror=a.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)}}).catch(function(){return!1})}function nc(a,b){a.objectStore(ye).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(a){b(a.target.result)}}function oc(a,b,c,d){try{a(b,c)}catch(b){d.emit("error",b)}}function pc(){!Ge&&He.length&&(Ge=!0,He.shift()())}function qc(a,b,c){He.push(function(){a(function(a,d){oc(b,a,d,c),Ge=!1,Bd(function(){pc(c)})})}),pc()}function rc(a,b,c,d){function e(b,c,d){function e(b,c){var d=a.processChange(c,b,a);m=d.seq=b.seq;var e=u(d);return"object"==typeof e?Promise.reject(e):e?(t++,a.return_docs&&s.push(d),a.attachments&&a.include_docs?new Promise(function(b){cc(c,a,o,function(){dc([d],a.binary).then(function(){b(d)})})}):Promise.resolve(d)):Promise.resolve()}function f(){for(var b=[],c=0,f=h.length;c<f&&t!==n;c++){var g=h[c];if(g){var j=i[c];b.push(e(j,g))}}Promise.all(b).then(function(b){for(var c=0,d=b.length;c<d;c++)b[c]&&a.onChange(b[c])}).catch(a.complete),t!==n&&d.continue()}if(d&&b.length){var h=new Array(b.length),i=new Array(b.length),j=0;c.forEach(function(a,c){g(ac(a),b[c],function(a,d){i[c]=a,h[c]=d,++j===b.length&&f()})})}}function f(a,b,c,d){if(c.seq!==b)return d();if(c.winningRev===a._rev)return d(c,a);var e=a._id+"::"+c.winningRev;r.get(e).onsuccess=function(a){d(c,ac(a.target.result))}}function g(a,b,c){if(l&&!l.has(a._id))return c();var d=v.get(a._id);if(d)return f(a,b,d,c);q.get(a._id).onsuccess=function(e){d=_b(e.target.result),v.set(a._id,d),f(a,b,d,c)}}function h(){a.complete(null,{results:s,last_seq:m})}function i(){!a.continuous&&a.attachments?dc(s).then(h):h()}if(a=j(a),a.continuous){var k=c+":"+ke();return Fe.addListener(c,k,b,a),Fe.notify(c),{cancel:function(){Fe.removeListener(c,k)}}}var l=a.doc_ids&&new Jd(a.doc_ids);a.since=a.since||0;var m=a.since,n="limit"in a?a.limit:-1;0===n&&(n=1);var o,p,q,r,s=[],t=0,u=H(a),v=new Kd,w=[ye,ze];a.attachments&&w.push(Ae);var x=fc(d,w,"readonly");if(x.error)return a.complete(x.error);o=x.txn,o.onabort=Zb(a.complete),o.oncomplete=i,p=o.objectStore(ze),q=o.objectStore(ye),r=p.index("_doc_id_rev"),hc(p,a.since&&!a.descending?IDBKeyRange.lowerBound(a.since,!0):null,a.descending,n,e)}function sc(a,b){var c=this;qc(function(b){tc(c,a,b)},b,c.constructor)}function tc(a,b,c){function d(a){var b=a.createObjectStore(ye,{keyPath:"id"});a.createObjectStore(ze,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),a.createObjectStore(Ae,{keyPath:"digest"}),a.createObjectStore(Ce,{keyPath:"id",autoIncrement:!1}),a.createObjectStore(Ee),b.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),a.createObjectStore(De,{keyPath:"_id"});var c=a.createObjectStore(Be,{autoIncrement:!0});c.createIndex("seq","seq"),c.createIndex("digestSeq","digestSeq",{unique:!0})}function e(a,b){var c=a.objectStore(ye);c.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),c.openCursor().onsuccess=function(a){var d=a.target.result;if(d){var e=d.value,f=ya(e);e.deletedOrLocal=f?"1":"0",c.put(e),d.continue()}else b()}}function f(a){a.createObjectStore(De,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function g(a,b){var c=a.objectStore(De),d=a.objectStore(ye),e=a.objectStore(ze);d.openCursor().onsuccess=function(a){var f=a.target.result;if(f){var g=f.value,h=g.id,i=za(h),j=ga(g);if(i){var k=h+"::"+j,l=h+"::",m=h+"::~",n=e.index("_doc_id_rev"),o=IDBKeyRange.bound(l,m,!1,!1),p=n.openCursor(o);p.onsuccess=function(a){if(p=a.target.result){var b=p.value;b._doc_id_rev===k&&c.put(b),e.delete(p.primaryKey),p.continue()}else d.delete(f.primaryKey),f.continue()}}else f.continue()}else b&&b()}}function h(a){var b=a.createObjectStore(Be,{autoIncrement:!0});b.createIndex("seq","seq"),b.createIndex("digestSeq","digestSeq",{unique:!0})}function i(a,b){var c=a.objectStore(ze),d=a.objectStore(Ae),e=a.objectStore(Be);d.count().onsuccess=function(a){if(!a.target.result)return b();c.openCursor().onsuccess=function(a){var c=a.target.result;if(!c)return b();for(var d=c.value,f=c.primaryKey,g=Object.keys(d._attachments||{}),h={},i=0;i<g.length;i++)h[d._attachments[g[i]].digest]=!0;var j=Object.keys(h);for(i=0;i<j.length;i++){var k=j[i];e.put({seq:f,digestSeq:k+"::"+f})}c.continue()}}}function j(a){function b(a){return a.data?_b(a):(a.deleted="1"===a.deletedOrLocal,a)}var c=a.objectStore(ze),d=a.objectStore(ye);d.openCursor().onsuccess=function(a){function e(){var a=$b(g,g.winningRev,g.deleted);d.put(a).onsuccess=function(){f.continue()}}var f=a.target.result;if(f){var g=b(f.value);if(g.winningRev=g.winningRev||ga(g),g.seq)return e();!function(){var a=g.id+"::",b=g.id+"::￿",d=c.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,b)),f=0;d.onsuccess=function(a){var b=a.target.result;if(!b)return g.seq=f,e();var c=b.primaryKey;c>f&&(f=c),b.continue()}}()}}}var k=b.name,m=null;a._meta=null,a._remote=!1,a.type=function(){return"idb"},a._id=l(function(b){b(null,a._meta.instanceId)}),a._bulkDocs=function(c,d,e){gc(b,c,d,a,m,e)},a._get=function(a,b,c){function d(){c(g,{doc:e,metadata:f,ctx:h})}var e,f,g,h=b.ctx;if(!h){var i=fc(m,[ye,ze,Ae],"readonly");if(i.error)return c(i.error);h=i.txn}h.objectStore(ye).get(a).onsuccess=function(a){if(!(f=_b(a.target.result)))return g=E(Qd,"missing"),d();var c;if(b.rev)c=b.latest?Aa(b.rev,f):b.rev;else{c=f.winningRev;if(ya(f))return g=E(Qd,"deleted"),d()}var i=h.objectStore(ze),j=f.id+"::"+c;i.index("_doc_id_rev").get(j).onsuccess=function(a){if(e=a.target.result,e&&(e=ac(e)),!e)return g=E(Qd,"missing"),d();d()}}},a._getAttachment=function(a,b,c,d,e){var f;if(d.ctx)f=d.ctx;else{var g=fc(m,[ye,ze,Ae],"readonly");if(g.error)return e(g.error);f=g.txn}var h=c.digest,i=c.content_type;f.objectStore(Ae).get(h).onsuccess=function(a){bc(a.target.result.body,i,d.binary,function(a){e(null,a)})}},a._info=function(b){var c,d,e=fc(m,[Ce,ze],"readonly");if(e.error)return b(e.error);var f=e.txn;f.objectStore(Ce).get(Ce).onsuccess=function(a){d=a.target.result.docCount},f.objectStore(ze).openCursor(null,"prev").onsuccess=function(a){var b=a.target.result;c=b?b.key:0},f.oncomplete=function(){b(null,{doc_count:d,update_seq:c,idb_attachment_format:a._meta.blobSupport?"binary":"base64"})}},a._allDocs=function(a,b){lc(a,m,b)},a._changes=function(b){return rc(b,a,k,m)},a._close=function(a){m.close(),Ie.delete(k),a()},a._getRevisionTree=function(a,b){var c=fc(m,[ye],"readonly");if(c.error)return b(c.error);c.txn.objectStore(ye).get(a).onsuccess=function(a){var c=_b(a.target.result);c?b(null,c.rev_tree):b(E(Qd))}},a._doCompaction=function(a,b,c){var d=[ye,ze,Ae,Be],e=fc(m,d,"readwrite");if(e.error)return c(e.error);var f=e.txn;f.objectStore(ye).get(a).onsuccess=function(c){var d=_b(c.target.result);ha(d.rev_tree,function(a,c,d,e,f){var g=c+"-"+d;-1!==b.indexOf(g)&&(f.status="missing")}),ec(b,a,f);var e=d.winningRev,g=d.deleted;f.objectStore(ye).put($b(d,e,g))},f.onabort=Zb(c),f.oncomplete=function(){c()}},a._getLocal=function(a,b){var c=fc(m,[De],"readonly");if(c.error)return b(c.error);var d=c.txn,e=d.objectStore(De).get(a);e.onerror=Zb(b),e.onsuccess=function(a){var c=a.target.result;c?(delete c._doc_id_rev,b(null,c)):b(E(Qd))}},a._putLocal=function(a,b,c){"function"==typeof b&&(c=b,b={}),delete a._revisions;var d=a._rev,e=a._id;a._rev=d?"0-"+(parseInt(d.split("-")[1],10)+1):"0-1";var f,g=b.ctx;if(!g){var h=fc(m,[De],"readwrite");if(h.error)return c(h.error);g=h.txn,g.onerror=Zb(c),g.oncomplete=function(){f&&c(null,f)}}var i,j=g.objectStore(De);d?(i=j.get(e),i.onsuccess=function(e){var g=e.target.result;if(g&&g._rev===d){j.put(a).onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)}}else c(E(Rd))}):(i=j.add(a),i.onerror=function(a){c(E(Rd)),a.preventDefault(),a.stopPropagation()},i.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)})},a._removeLocal=function(a,b,c){"function"==typeof b&&(c=b,b={});var d=b.ctx;if(!d){var e=fc(m,[De],"readwrite");if(e.error)return c(e.error);d=e.txn,d.oncomplete=function(){f&&c(null,f)}}var f,g=a._id,h=d.objectStore(De),i=h.get(g);i.onerror=Zb(c),i.onsuccess=function(d){var e=d.target.result;e&&e._rev===a._rev?(h.delete(g),f={ok:!0,id:g,rev:"0-0"},b.ctx&&c(null,f)):c(E(Qd))}},a._destroy=function(a,b){Fe.removeAllListeners(k);var c=Je.get(k);c&&c.result&&(c.result.close(),Ie.delete(k));var d=indexedDB.deleteDatabase(k);d.onsuccess=function(){Je.delete(k),w()&&k in localStorage&&delete localStorage[k],b(null,{ok:!0})},d.onerror=Zb(b)};var n=Ie.get(k);if(n)return m=n.idb,a._meta=n.global,Bd(function(){c(null,a)});var o=indexedDB.open(k,xe);Je.set(k,o),o.onupgradeneeded=function(a){function b(){var a=l[m-1];m++,a&&a(k,b)}var c=a.target.result;if(a.oldVersion<1)return d(c);var k=a.currentTarget.transaction;a.oldVersion<3&&f(c),a.oldVersion<4&&h(c);var l=[e,g,i,j],m=a.oldVersion;b()},o.onsuccess=function(b){function d(){void 0!==h&&l&&(a._meta={name:k,instanceId:i,blobSupport:h},Ie.set(k,{idb:m,global:a._meta}),c(null,a))}function e(){if(void 0!==g&&void 0!==f){var a=k+"_id";a in f?i=f[a]:f[a]=i=ke(),f.docCount=g,j.objectStore(Ce).put(f)}}m=b.target.result,m.onversionchange=function(){m.close(),Ie.delete(k)},m.onabort=function(a){z("error","Database has a global failure",a.target.error),m.close(),Ie.delete(k)};var f,g,h,i,j=m.transaction([Ce,Ee,ye],"readwrite"),l=!1;j.objectStore(Ce).get(Ce).onsuccess=function(a){f=a.target.result||{id:Ce},e()},nc(j,function(a){g=a,e()}),ue||(ue=mc(j)),ue.then(function(a){h=a,d()}),j.oncomplete=function(){l=!0,d()},j.onabort=Zb(c)},o.onerror=function(){var a="Failed to open indexedDB, are you in private browsing mode?";z("error",a),c(E(_d,a))}}function uc(a){a.adapter("idb",sc,!0)}function vc(a,b){return new Promise(function(c,d){function e(){k++,a[l++]().then(g,h)}function f(){++m===n?j?d(j):c():i()}function g(){k--,f()}function h(a){k--,j=j||a,f()}function i(){for(;k<b&&l<n;)e()}var j,k=0,l=0,m=0,n=a.length;i()})}function wc(a){var b=a.doc||a.ok,c=b._attachments;c&&Object.keys(c).forEach(function(a){var b=c[a];b.data=V(b.data,b.content_type)})}function xc(a){return/^_design/.test(a)?"_design/"+encodeURIComponent(a.slice(8)):/^_local/.test(a)?"_local/"+encodeURIComponent(a.slice(7)):encodeURIComponent(a)}function yc(a){return a._attachments&&Object.keys(a._attachments)?Promise.all(Object.keys(a._attachments).map(function(b){var c=a._attachments[b];if(c.data&&"string"!=typeof c.data)return new Promise(function(a){Z(c.data,a)}).then(function(a){c.data=a})})):Promise.resolve()}function zc(a){if(!a.prefix)return!1;var b=O(a.prefix).protocol;return"http"===b||"https"===b}function Ac(a,b){if(zc(b)){var c=b.name.substr(b.prefix.length);a=b.prefix.replace(/\/?$/,"/")+encodeURIComponent(c)}var d=O(a);(d.user||d.password)&&(d.auth={username:d.user,password:d.password});var e=d.path.replace(/(^\/|\/$)/g,"").split("/");return d.db=e.pop(),-1===d.db.indexOf("%")&&(d.db=encodeURIComponent(d.db)),d.path=e.join("/"),d}function Bc(a,b){return Cc(a,a.db+"/"+b)}function Cc(a,b){var c=a.path?"/":"";return a.protocol+"://"+a.host+(a.port?":"+a.port:"")+"/"+a.path+c+b}function Dc(a){return"?"+Object.keys(a).map(function(b){return b+"="+encodeURIComponent(a[b])}).join("&")}function Ec(a){var b="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",c=-1!==b.indexOf("msie"),d=-1!==b.indexOf("trident"),e=-1!==b.indexOf("edge"),f=!("method"in a)||"GET"===a.method;return(c||d||e)&&f}function Fc(a,b){function d(a,b){return n(a,Ad(function(a){f().then(function(){return b.apply(this,a)}).catch(function(b){a.pop()(b)})})).bind(h)}function e(a,b,c){var d={};return b=b||{},b.headers=b.headers||new ne,b.headers.get("Content-Type")||b.headers.set("Content-Type","application/json"),b.headers.get("Accept")||b.headers.set("Accept","application/json"),m(a,b).then(function(a){return d.ok=a.ok,d.status=a.status,a.json()}).then(function(a){if(d.data=a,!d.ok){d.data.status=d.status;var b=F(d.data);if(c)return c(b);throw b}if(Array.isArray(d.data)&&(d.data=d.data.map(function(a){return a.error||a.missing?F(a):a})),!c)return d;c(null,d.data)})}function f(){return a.skip_setup?Promise.resolve():l||(l=e(k).catch(function(a){return a&&a.status&&404===a.status?(C(404,"PouchDB is just detecting if the remote exists."),e(k,{method:"PUT"})):Promise.reject(a)}).catch(function(a){return!(!a||!a.status||412!==a.status)||Promise.reject(a)}),l.catch(function(){l=null}),l)}function g(a){return a.split("/").map(encodeURIComponent).join("/")}var h=this,i=Ac(a.name,a),k=Bc(i,"");a=j(a);var l,m=function(b,c){if(c=c||{},c.headers=c.headers||new ne,a.auth||i.auth){var d=a.auth||i.auth,e=d.username+":"+d.password,f=he(unescape(encodeURIComponent(e)));c.headers.set("Authorization","Basic "+f)}var g=a.headers||{};return Object.keys(g).forEach(function(a){c.headers.append(a,g[a])}),Ec(c)&&(b+=(-1===b.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(a.fetch||me)(b,c)};Bd(function(){b(null,h)}),h._remote=!0,h.type=function(){return"http"},h.id=d("id",function(a){m(Cc(i,"")).then(function(a){return a.json()}).then(function(b){var c=b&&b.uuid?b.uuid+i.db:Bc(i,"");a(null,c)}).catch(function(b){a(b)})}),h.compact=d("compact",function(a,b){"function"==typeof a&&(b=a,a={}),a=j(a),e(Bc(i,"_compact"),{method:"POST"}).then(function(){function c(){h.info(function(d,e){e&&!e.compact_running?b(null,{ok:!0}):setTimeout(c,a.interval||200)})}c()})}),h.bulkGet=n("bulkGet",function(a,b){function c(b){var c={};a.revs&&(c.revs=!0),a.attachments&&(c.attachments=!0),a.latest&&(c.latest=!0),e(Bc(i,"_bulk_get"+Dc(c)),{method:"POST",body:JSON.stringify({docs:a.docs})}).then(function(c){a.attachments&&a.binary&&c.data.results.forEach(function(a){a.docs.forEach(wc)}),b(null,c.data)}).catch(b)}function d(){for(var c=Le,d=Math.ceil(a.docs.length/c),e=0,g=new Array(d),h=0;h<d;h++){var i=s(a,["revs","attachments","binary","latest"]);i.docs=a.docs.slice(h*c,Math.min(a.docs.length,(h+1)*c)),v(f,i,function(a){return function(c,f){g[a]=f.results,++e===d&&b(null,{results:I(g)})}}(h))}}var f=this,g=Cc(i,""),h=Oe[g];"boolean"!=typeof h?c(function(a,c){a?(Oe[g]=!1,C(a.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),d()):(Oe[g]=!0,b(null,c))}):h?c(b):d()}),h._info=function(a){f().then(function(){return m(Bc(i,""))}).then(function(a){return a.json()}).then(function(b){b.host=Bc(i,""),a(null,b)}).catch(a)},h.fetch=function(a,b){return f().then(function(){return m(Bc(i,a),b)})},h.get=d("get",function(a,b,d){function f(a){function d(d){var f=e[d],h=xc(a._id)+"/"+g(d)+"?rev="+a._rev;return m(Bc(i,h)).then(function(a){return void 0===c||c.browser?a.blob():a.buffer()}).then(function(a){return b.binary?(void 0===c||c.browser||(a.type=f.content_type),a):new Promise(function(b){Z(a,b)})}).then(function(a){delete f.stub,delete f.length,f.data=a})}var e=a._attachments,f=e&&Object.keys(e);if(e&&f.length){return vc(f.map(function(a){return function(){return d(a)}}),5)}}function h(a){return Array.isArray(a)?Promise.all(a.map(function(a){if(a.ok)return f(a.ok)})):f(a)}"function"==typeof b&&(d=b,b={}),b=j(b);var k={};b.revs&&(k.revs=!0),b.revs_info&&(k.revs_info=!0),b.latest&&(k.latest=!0),b.open_revs&&("all"!==b.open_revs&&(b.open_revs=JSON.stringify(b.open_revs)),k.open_revs=b.open_revs),b.rev&&(k.rev=b.rev),b.conflicts&&(k.conflicts=b.conflicts),b.update_seq&&(k.update_seq=b.update_seq),a=xc(a),e(Bc(i,a+Dc(k))).then(function(a){return Promise.resolve().then(function(){if(b.attachments)return h(a.data)}).then(function(){d(null,a.data)})}).catch(function(b){b.docId=a,d(b)})}),h.remove=d("remove",function(a,b,c,d){var f;"string"==typeof b?(f={_id:a,_rev:b},"function"==typeof c&&(d=c,c={})):(f=a,"function"==typeof b?(d=b,c={}):(d=c,c=b));var g=f._rev||c.rev;e(Bc(i,xc(f._id))+"?rev="+g,{method:"DELETE"},d).catch(d)}),h.getAttachment=d("getAttachment",function(a,b,d,e){"function"==typeof d&&(e=d,d={});var f,h=d.rev?"?rev="+d.rev:"",j=Bc(i,xc(a))+"/"+g(b)+h;m(j,{method:"GET"}).then(function(a){if(f=a.headers.get("content-type"),a.ok)return void 0===c||c.browser?a.blob():a.buffer();throw a}).then(function(a){void 0===c||c.browser||(a.type=f),e(null,a)}).catch(function(a){e(a)})}),h.removeAttachment=d("removeAttachment",function(a,b,c,d){e(Bc(i,xc(a)+"/"+g(b))+"?rev="+c,{method:"DELETE"},d).catch(d)}),h.putAttachment=d("putAttachment",function(a,b,c,d,f,h){"function"==typeof f&&(h=f,f=d,d=c,c=null);var j=xc(a)+"/"+g(b),k=Bc(i,j);if(c&&(k+="?rev="+c),"string"==typeof d){var l;try{l=ge(d)}catch(a){return h(E(Wd,"Attachment is not a valid base64 string"))}d=l?U(l,f):""}e(k,{headers:new ne({"Content-Type":f}),method:"PUT",body:d},h).catch(h)}),h._bulkDocs=function(a,b,c){a.new_edits=b.new_edits,f().then(function(){return Promise.all(a.docs.map(yc))}).then(function(){return e(Bc(i,"_bulk_docs"),{method:"POST",body:JSON.stringify(a)},c)}).catch(c)},h._put=function(a,b,c){f().then(function(){return yc(a)}).then(function(){return e(Bc(i,xc(a._id)),{method:"PUT",body:JSON.stringify(a)})}).then(function(a){c(null,a.data)}).catch(function(b){b.docId=a&&a._id,c(b)})},h.allDocs=d("allDocs",function(a,b){"function"==typeof a&&(b=a,a={}),a=j(a);var c,d={},f="GET";a.conflicts&&(d.conflicts=!0),a.update_seq&&(d.update_seq=!0),a.descending&&(d.descending=!0),a.include_docs&&(d.include_docs=!0),a.attachments&&(d.attachments=!0),a.key&&(d.key=JSON.stringify(a.key)),a.start_key&&(a.startkey=a.start_key),a.startkey&&(d.startkey=JSON.stringify(a.startkey)),a.end_key&&(a.endkey=a.end_key),a.endkey&&(d.endkey=JSON.stringify(a.endkey)),void 0!==a.inclusive_end&&(d.inclusive_end=!!a.inclusive_end),void 0!==a.limit&&(d.limit=a.limit),void 0!==a.skip&&(d.skip=a.skip);var g=Dc(d);void 0!==a.keys&&(f="POST",c={keys:a.keys}),e(Bc(i,"_all_docs"+g),{method:f,body:JSON.stringify(c)}).then(function(c){a.include_docs&&a.attachments&&a.binary&&c.data.rows.forEach(wc),b(null,c.data)}).catch(b)}),h._changes=function(a){var b="batch_size"in a?a.batch_size:Ke;a=j(a),!a.continuous||"heartbeat"in a||(a.heartbeat=Ne);var c="timeout"in a?a.timeout:3e4;"timeout"in a&&a.timeout&&c-a.timeout<Me&&(c=a.timeout+Me),"heartbeat"in a&&a.heartbeat&&c-a.heartbeat<Me&&(c=a.heartbeat+Me);var d={};"timeout"in a&&a.timeout&&(d.timeout=a.timeout);var g=void 0!==a.limit&&a.limit,h=g;if(a.style&&(d.style=a.style),(a.include_docs||a.filter&&"function"==typeof a.filter)&&(d.include_docs=!0),a.attachments&&(d.attachments=!0),a.continuous&&(d.feed="longpoll"),a.seq_interval&&(d.seq_interval=a.seq_interval),a.conflicts&&(d.conflicts=!0),a.descending&&(d.descending=!0),a.update_seq&&(d.update_seq=!0),"heartbeat"in a&&a.heartbeat&&(d.heartbeat=a.heartbeat),a.filter&&"string"==typeof a.filter&&(d.filter=a.filter),a.view&&"string"==typeof a.view&&(d.filter="_view",d.view=a.view),a.query_params&&"object"==typeof a.query_params)for(var k in a.query_params)a.query_params.hasOwnProperty(k)&&(d[k]=a.query_params[k]);var l,m="GET";a.doc_ids?(d.filter="_doc_ids",m="POST",l={doc_ids:a.doc_ids}):a.selector&&(d.filter="_selector",m="POST",l={selector:a.selector});var n,o=new le,p=function(c,j){if(!a.aborted){d.since=c,"object"==typeof d.since&&(d.since=JSON.stringify(d.since)),a.descending?g&&(d.limit=h):d.limit=!g||h>b?b:h;var k=Bc(i,"_changes"+Dc(d)),p={signal:o.signal,method:m,body:JSON.stringify(l)};n=c,a.aborted||f().then(function(){return e(k,p,j)}).catch(j)}},q={results:[]},r=function(c,d){if(!a.aborted){var e=0;if(d&&d.results){e=d.results.length,q.last_seq=d.last_seq;var f=null,i=null;"number"==typeof d.pending&&(f=d.pending),"string"!=typeof q.last_seq&&"number"!=typeof q.last_seq||(i=q.last_seq);({}).query=a.query_params,d.results=d.results.filter(function(b){h--;var c=H(a)(b);return c&&(a.include_docs&&a.attachments&&a.binary&&wc(b),a.return_docs&&q.results.push(b),a.onChange(b,f,i)),c})}else if(c)return a.aborted=!0,void a.complete(c);d&&d.last_seq&&(n=d.last_seq);var j=g&&h<=0||d&&e<b||a.descending;(!a.continuous||g&&h<=0)&&j?a.complete(null,q):Bd(function(){p(n,r)})}};return p(a.since||0,r),{cancel:function(){a.aborted=!0,o.abort()}}},h.revsDiff=d("revsDiff",function(a,b,c){"function"==typeof b&&(c=b,b={}),e(Bc(i,"_revs_diff"),{method:"POST",body:JSON.stringify(a)},c).catch(c)}),h._close=function(a){a()},h._destroy=function(a,b){e(Bc(i,""),{method:"DELETE"}).then(function(a){b(null,a)}).catch(function(a){404===a.status?b(null,{ok:!0}):b(a)})}}function Gc(a){a.adapter("http",Fc,!1),a.adapter("https",Fc,!1)}function Hc(a){this.status=400,this.name="query_parse_error",this.message=a,this.error=!0;try{Error.captureStackTrace(this,Hc)}catch(a){}}function Ic(a){this.status=404,this.name="not_found",this.message=a,this.error=!0;try{Error.captureStackTrace(this,Ic)}catch(a){}}function Jc(a){this.status=500,this.name="invalid_value",this.message=a,this.error=!0;try{
Error.captureStackTrace(this,Jc)}catch(a){}}function Kc(a,b){return b&&a.then(function(a){Bd(function(){b(null,a)})},function(a){Bd(function(){b(a)})}),a}function Lc(a){return Ad(function(b){var c=b.pop(),d=a.apply(this,b);return"function"==typeof c&&Kc(d,c),d})}function Mc(a,b){return a.then(function(a){return b().then(function(){return a})},function(a){return b().then(function(){throw a})})}function Nc(a,b){return function(){var c=arguments,d=this;return a.add(function(){return b.apply(d,c)})}}function Oc(a){var b=new Jd(a),c=new Array(b.size),d=-1;return b.forEach(function(a){c[++d]=a}),c}function Pc(a){var b=new Array(a.size),c=-1;return a.forEach(function(a,d){b[++c]=d}),b}function Qc(a){return new Jc("builtin "+a+" function requires map values to be numbers or number arrays")}function Rc(a){for(var b=0,c=0,d=a.length;c<d;c++){var e=a[c];if("number"!=typeof e){if(!Array.isArray(e))throw Qc("_sum");b="number"==typeof b?[b]:b;for(var f=0,g=e.length;f<g;f++){var h=e[f];if("number"!=typeof h)throw Qc("_sum");void 0===b[f]?b.push(h):b[f]+=h}}else"number"==typeof b?b+=e:b[0]+=e}return b}function Sc(a,b){return P("return ("+a.replace(/;\s*$/,"")+");",{emit:b,sum:Rc,log:Pe,isArray:Qe,toJSON:Re})}function Tc(){this.promise=new Promise(function(a){a()})}function Uc(a){if(!a)return"undefined";switch(typeof a){case"function":case"string":return a.toString();default:return JSON.stringify(a)}}function Vc(a,b){return Uc(a)+Uc(b)+"undefined"}function Wc(a,b,c,d,e,f){var g,h=Vc(c,d);if(!e&&(g=a._cachedViews=a._cachedViews||{},g[h]))return g[h];var i=a.info().then(function(i){function j(a){a.views=a.views||{};var c=b;-1===c.indexOf("/")&&(c=b+"/"+b);var d=a.views[c]=a.views[c]||{};if(!d[k])return d[k]=!0,a}var k=i.db_name+"-mrview-"+(e?"temp":ea(h));return Q(a,"_local/"+f,j).then(function(){return a.registerDependentDatabase(k).then(function(b){var e=b.db;e.auto_compaction=!0;var f={name:k,db:e,sourceDB:a,adapter:a.adapter,mapFun:c,reduceFun:d};return f.db.get("_local/lastSeq").catch(function(a){if(404!==a.status)throw a}).then(function(a){return f.seq=a?a.seq:0,g&&f.db.once("destroyed",function(){delete g[h]}),f})})})});return g&&(g[h]=i),i}function Xc(a){return-1===a.indexOf("/")?[a,a]:a.split("/")}function Yc(a){return 1===a.length&&/^1-/.test(a[0].rev)}function Zc(a,b){try{a.emit("error",b)}catch(a){z("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),z("error",b)}}function $c(a){if(/^_sum/.test(a))return Ve._sum;if(/^_count/.test(a))return Ve._count;if(/^_stats/.test(a))return Ve._stats;if(/^_/.test(a))throw new Error(a+" is not a supported reduce function.")}function _c(a,b){if("function"==typeof a&&2===a.length){var c=a;return function(a){return c(a,b)}}return Sc(a.toString(),b)}function ad(a){var b=a.toString(),c=$c(b);return c||Sc(b)}function bd(a,b){var c=a.views&&a.views[b];if("string"!=typeof c.map)throw new Ic("ddoc "+a._id+" has no string view named "+b+", instead found object of type: "+typeof c.map)}function cd(a,b,c){return We.query.call(this,a,b,c)}function dd(a){return We.viewCleanup.call(this,a)}function ed(a){return/^1-/.test(a)}function fd(a,b,c){return!a._attachments||!a._attachments[c]||a._attachments[c].digest!==b._attachments[c].digest}function gd(a,b){var c=Object.keys(b._attachments);return Promise.all(c.map(function(c){return a.getAttachment(b._id,c,{rev:b._rev})}))}function hd(a,b,c){var d=K(b)&&!K(a),e=Object.keys(c._attachments);return d?a.get(c._id).then(function(d){return Promise.all(e.map(function(e){return fd(d,c,e)?b.getAttachment(c._id,e):a.getAttachment(d._id,e)}))}).catch(function(a){if(404!==a.status)throw a;return gd(b,c)}):gd(b,c)}function id(a){var b=[];return Object.keys(a).forEach(function(c){a[c].missing.forEach(function(a){b.push({id:c,rev:a})})}),{docs:b,revs:!0,latest:!0}}function jd(a,b,c,d){function e(){var e=id(c);if(e.docs.length)return a.bulkGet(e).then(function(c){if(d.cancelled)throw new Error("cancelled");return Promise.all(c.results.map(function(c){return Promise.all(c.docs.map(function(c){var d=c.ok;return c.error&&(m=!1),d&&d._attachments?hd(b,a,d).then(function(a){var b=Object.keys(d._attachments);return a.forEach(function(a,c){var e=d._attachments[b[c]];delete e.stub,delete e.length,e.data=a}),d}):d}))})).then(function(a){l=l.concat(I(a).filter(Boolean))})})}function f(a){return a._attachments&&Object.keys(a._attachments).length>0}function g(a){return a._conflicts&&a._conflicts.length>0}function h(b){return a.allDocs({keys:b,include_docs:!0,conflicts:!0}).then(function(a){if(d.cancelled)throw new Error("cancelled");a.rows.forEach(function(a){a.deleted||!a.doc||!ed(a.value.rev)||f(a.doc)||g(a.doc)||(a.doc._conflicts&&delete a.doc._conflicts,l.push(a.doc),delete c[a.id])})})}function i(){var a=Object.keys(c).filter(function(a){var b=c[a].missing;return 1===b.length&&ed(b[0])});if(a.length>0)return h(a)}function k(){return{ok:m,docs:l}}c=j(c);var l=[],m=!0;return Promise.resolve().then(i).then(e).then(k)}function kd(a,b,c,d,e){return a.get(b).catch(function(c){if(404===c.status)return"http"!==a.adapter&&"https"!==a.adapter||C(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:d,_id:b,history:[],replicator:Ze,version:Ye};throw c}).then(function(f){if(!e.cancelled&&f.last_seq!==c)return f.history=(f.history||[]).filter(function(a){return a.session_id!==d}),f.history.unshift({last_seq:c,session_id:d}),f.history=f.history.slice(0,$e),f.version=Ye,f.replicator=Ze,f.session_id=d,f.last_seq=c,a.put(f).catch(function(f){if(409===f.status)return kd(a,b,c,d,e);throw f})})}function ld(a,b,c,d,e){this.src=a,this.target=b,this.id=c,this.returnValue=d,this.opts=e||{}}function md(a,b){return a.session_id===b.session_id?{last_seq:a.last_seq,history:a.history}:nd(a.history,b.history)}function nd(a,b){var c=a[0],d=a.slice(1),e=b[0],f=b.slice(1);return c&&0!==b.length?od(c.session_id,b)?{last_seq:c.last_seq,history:a}:od(e.session_id,d)?{last_seq:e.last_seq,history:f}:nd(d,f):{last_seq:_e,history:[]}}function od(a,b){var c=b[0],d=b.slice(1);return!(!a||0===b.length)&&(a===c.session_id||od(a,d))}function pd(a){return"number"==typeof a.status&&4===Math.floor(a.status/100)}function qd(a,b,c,d){if(!1===a.retry)return b.emit("error",c),void b.removeAllListeners();if("function"!=typeof a.back_off_function&&(a.back_off_function=B),b.emit("requestError",c),"active"===b.state||"pending"===b.state){b.emit("paused",c),b.state="stopped";var e=function(){a.current_back_off=bf},f=function(){b.removeListener("active",e)};b.once("paused",f),b.once("active",e)}a.current_back_off=a.current_back_off||bf,a.current_back_off=a.back_off_function(a.current_back_off),setTimeout(d,a.current_back_off)}function rd(a){return Object.keys(a).sort(db).reduce(function(b,c){return b[c]=a[c],b},{})}function sd(a,b,c){var d=c.doc_ids?c.doc_ids.sort(db):"",e=c.filter?c.filter.toString():"",f="",g="",h="";return c.selector&&(h=JSON.stringify(c.selector)),c.filter&&c.query_params&&(f=JSON.stringify(rd(c.query_params))),c.filter&&"_view"===c.filter&&(g=c.view.toString()),Promise.all([a.id(),b.id()]).then(function(a){var b=a[0]+a[1]+e+g+f+d+h;return new Promise(function(a){da(b,a)})}).then(function(a){return"_local/"+(a=a.replace(/\//g,".").replace(/\+/g,"_"))})}function td(a,b,c,d,e){function f(){return x?Promise.resolve():sd(a,b,c).then(function(e){w=e;var f={};f=!1===c.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===c.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===c.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},x=new ld(a,b,w,d,f)})}function g(){if(M=[],0!==v.docs.length){var a=v.docs,f={timeout:c.timeout};return b.bulkDocs({docs:a,new_edits:!1},f).then(function(b){if(d.cancelled)throw o(),new Error("cancelled");var c=Object.create(null);b.forEach(function(a){a.error&&(c[a.id]=a)});var f=Object.keys(c).length;e.doc_write_failures+=f,e.docs_written+=a.length-f,a.forEach(function(a){var b=c[a._id];if(b){e.errors.push(b);var f=(b.name||"").toLowerCase();if("unauthorized"!==f&&"forbidden"!==f)throw b;d.emit("denied",j(b))}else M.push(a)})},function(b){throw e.doc_write_failures+=a.length,b})}}function h(){if(v.error)throw new Error("There was a problem getting docs.");e.last_seq=D=v.seq;var a=j(e);return M.length&&(a.docs=M,"number"==typeof v.pending&&(a.pending=v.pending,delete v.pending),d.emit("change",a)),A=!0,x.writeCheckpoint(v.seq,N).then(function(){if(A=!1,d.cancelled)throw o(),new Error("cancelled");v=void 0,s()}).catch(function(a){throw u(a),a})}function i(){var a={};return v.changes.forEach(function(b){"_user/"!==b.id&&(a[b.id]=b.changes.map(function(a){return a.rev}))}),b.revsDiff(a).then(function(a){if(d.cancelled)throw o(),new Error("cancelled");v.diffs=a})}function k(){return jd(a,b,v.diffs,d).then(function(a){v.error=!a.ok,a.docs.forEach(function(a){delete v.diffs[a._id],e.docs_read++,v.docs.push(a)})})}function l(){if(!d.cancelled&&!v){if(0===y.length)return void m(!0);v=y.shift(),i().then(k).then(g).then(h).then(l).catch(function(a){n("batch processing terminated with error",a)})}}function m(a){if(0===z.changes.length)return void(0!==y.length||v||((F&&O.live||B)&&(d.state="pending",d.emit("paused")),B&&o()));(a||B||z.changes.length>=G)&&(y.push(z),z={seq:0,changes:[],docs:[]},"pending"!==d.state&&"stopped"!==d.state||(d.state="active",d.emit("active")),l())}function n(a,b){C||(b.message||(b.message=a),e.ok=!1,e.status="aborting",y=[],z={seq:0,changes:[],docs:[]},o(b))}function o(f){if(!(C||d.cancelled&&(e.status="cancelled",A)))if(e.status=e.status||"complete",e.end_time=(new Date).toISOString(),e.last_seq=D,C=!0,f){f=E(f),f.result=e;var g=(f.name||"").toLowerCase();"unauthorized"===g||"forbidden"===g?(d.emit("error",f),d.removeAllListeners()):qd(c,d,f,function(){td(a,b,c,d)})}else d.emit("complete",e),d.removeAllListeners()}function p(a,b,e){if(d.cancelled)return o();"number"==typeof b&&(z.pending=b),H(c)(a)&&(z.seq=a.seq||e,z.changes.push(a),Bd(function(){m(0===y.length&&O.live)}))}function q(a){if(J=!1,d.cancelled)return o();if(a.results.length>0)O.since=a.results[a.results.length-1].seq,s(),m(!0);else{var b=function(){F?(O.live=!0,s()):B=!0,m(!0)};v||0!==a.results.length?b():(A=!0,x.writeCheckpoint(a.last_seq,N).then(function(){A=!1,e.last_seq=D=a.last_seq,b()}).catch(u))}}function r(a){if(J=!1,d.cancelled)return o();n("changes rejected",a)}function s(){function b(){f.cancel()}function e(){d.removeListener("cancel",b)}if(!J&&!B&&y.length<I){J=!0,d._changes&&(d.removeListener("cancel",d._abortChanges),d._changes.cancel()),d.once("cancel",b);var f=a.changes(O).on("change",p);f.then(e,e),f.then(q).catch(r),c.retry&&(d._changes=f,d._abortChanges=b)}}function t(){f().then(function(){return d.cancelled?void o():x.getCheckpoint().then(function(a){D=a,O={since:D,limit:G,batch_size:G,style:"all_docs",doc_ids:K,selector:L,return_docs:!0},c.filter&&("string"!=typeof c.filter?O.include_docs=!0:O.filter=c.filter),"heartbeat"in c&&(O.heartbeat=c.heartbeat),"timeout"in c&&(O.timeout=c.timeout),c.query_params&&(O.query_params=c.query_params),c.view&&(O.view=c.view),s()})}).catch(function(a){n("getCheckpoint rejected with ",a)})}function u(a){A=!1,n("writeCheckpoint completed with error",a)}var v,w,x,y=[],z={seq:0,changes:[],docs:[]},A=!1,B=!1,C=!1,D=0,F=c.continuous||c.live||!1,G=c.batch_size||100,I=c.batches_limit||10,J=!1,K=c.doc_ids,L=c.selector,M=[],N=ke();e=e||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var O={};if(d.ready(a,b),d.cancelled)return void o();d._addedListeners||(d.once("cancel",o),"function"==typeof c.complete&&(d.once("error",c.complete),d.once("complete",function(a){c.complete(null,a)})),d._addedListeners=!0),void 0===c.since?t():f().then(function(){return A=!0,x.writeCheckpoint(c.since,N)}).then(function(){if(A=!1,d.cancelled)return void o();D=c.since,t()}).catch(u)}function ud(){Cd.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var a=this,b=new Promise(function(b,c){a.once("complete",b),a.once("error",c)});a.then=function(a,c){return b.then(a,c)},a.catch=function(a){return b.catch(a)},a.catch(function(){})}function vd(a,b){var c=b.PouchConstructor;return"string"==typeof a?new c(a,b):a}function wd(a,b,c,d){if("function"==typeof c&&(d=c,c={}),void 0===c&&(c={}),c.doc_ids&&!Array.isArray(c.doc_ids))throw E(Zd,"`doc_ids` filter parameter is not a list.");c.complete=d,c=j(c),c.continuous=c.continuous||c.live,c.retry="retry"in c&&c.retry,c.PouchConstructor=c.PouchConstructor||this;var e=new ud(c);return td(vd(a,c),vd(b,c),c,e),e}function xd(a,b,c,d){return"function"==typeof c&&(d=c,c={}),void 0===c&&(c={}),c=j(c),c.PouchConstructor=c.PouchConstructor||this,a=vd(a,c),b=vd(b,c),new yd(a,b,c,d)}function yd(a,b,c,d){function e(a){o.emit("change",{direction:"pull",change:a})}function f(a){o.emit("change",{direction:"push",change:a})}function g(a){o.emit("denied",{direction:"push",doc:a})}function h(a){o.emit("denied",{direction:"pull",doc:a})}function i(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function j(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function k(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function l(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}function m(a){return function(b,c){var d="change"===b&&(c===e||c===f),m="denied"===b&&(c===h||c===g),n="paused"===b&&(c===j||c===i),p="active"===b&&(c===l||c===k);(d||m||n||p)&&(b in r||(r[b]={}),r[b][a]=!0,2===Object.keys(r[b]).length&&o.removeAllListeners(b))}}function n(a,b,c){-1==a.listeners(b).indexOf(c)&&a.on(b,c)}var o=this;this.canceled=!1;var p=c.push?Od({},c,c.push):c,q=c.pull?Od({},c,c.pull):c;this.push=wd(a,b,p),this.pull=wd(b,a,q),this.pushPaused=!0,this.pullPaused=!0;var r={};c.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(a){"change"===a?(n(o.pull,"change",e),n(o.push,"change",f)):"denied"===a?(n(o.pull,"denied",h),n(o.push,"denied",g)):"active"===a?(n(o.pull,"active",l),n(o.push,"active",k)):"paused"===a&&(n(o.pull,"paused",j),n(o.push,"paused",i))}),this.on("removeListener",function(a){"change"===a?(o.pull.removeListener("change",e),o.push.removeListener("change",f)):"denied"===a?(o.pull.removeListener("denied",h),o.push.removeListener("denied",g)):"active"===a?(o.pull.removeListener("active",l),o.push.removeListener("active",k)):"paused"===a&&(o.pull.removeListener("paused",j),o.push.removeListener("paused",i))}),this.pull.on("removeListener",m("pull")),this.push.on("removeListener",m("push"));var s=Promise.all([this.push,this.pull]).then(function(a){var b={push:a[0],pull:a[1]};return o.emit("complete",b),d&&d(null,b),o.removeAllListeners(),b},function(a){if(o.cancel(),d?d(a):o.emit("error",a),o.removeAllListeners(),d)throw a});this.then=function(a,b){return s.then(a,b)},this.catch=function(a){return s.catch(a)}}function zd(a){a.replicate=wd,a.sync=xd,Object.defineProperty(a.prototype,"replicate",{get:function(){var a=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(b,c,d){return a.constructor.replicate(b,a,c,d)},to:function(b,c,d){return a.constructor.replicate(a,b,c,d)}}),this.replicateMethods}}),a.prototype.sync=function(a,b,c){return this.constructor.sync(this,a,b,c)}}var Ad=e(a("argsarray")),Bd=e(a("immediate")),Cd=a("events"),Dd=e(a("inherits")),Ed=e(a("spark-md5")),Fd=e(a("uuid")),Gd=e(a("vuvuzela")),Hd=Function.prototype.toString,Id=Hd.call(Object);q.prototype.get=function(a){var b=o(a);return this._store[b]},q.prototype.set=function(a,b){var c=o(a);return this._store[c]=b,!0},q.prototype.has=function(a){return o(a)in this._store},q.prototype.delete=function(a){var b=o(a),c=b in this._store;return delete this._store[b],c},q.prototype.forEach=function(a){for(var b=Object.keys(this._store),c=0,d=b.length;c<d;c++){var e=b[c],f=this._store[e];e=p(e),a(f,e)}},Object.defineProperty(q.prototype,"size",{get:function(){return Object.keys(this._store).length}}),r.prototype.add=function(a){return this._store.set(a,!0)},r.prototype.has=function(a){return this._store.has(a)},r.prototype.forEach=function(a){this._store.forEach(function(b,c){a(c)})},Object.defineProperty(r.prototype,"size",{get:function(){return this._store.size}});var Jd,Kd;!function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var a=Object.getOwnPropertyDescriptor(Map,Symbol.species);return a&&"get"in a&&Map[Symbol.species]===Map}()?(Jd=r,Kd=q):(Jd=Set,Kd=Map);var Ld,Md=6;try{localStorage.setItem("_pouch_check_localstorage",1),Ld=!!localStorage.getItem("_pouch_check_localstorage")}catch(a){Ld=!1}Dd(y,Cd.EventEmitter),y.prototype.addListener=function(a,b,c,d){function e(){function a(){g=!1}if(f._listeners[b]){if(g)return void(g="waiting");g=!0;var h=s(d,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);c.changes(h).on("change",function(a){a.seq>d.since&&!d.cancelled&&(d.since=a.seq,d.onChange(a))}).on("complete",function(){"waiting"===g&&Bd(e),g=!1}).on("error",a)}}if(!this._listeners[b]){var f=this,g=!1;this._listeners[b]=e,this.on(a,e)}},y.prototype.removeListener=function(a,b){b in this._listeners&&(Cd.EventEmitter.prototype.removeListener.call(this,a,this._listeners[b]),delete this._listeners[b])},y.prototype.notifyLocalWindows=function(a){w()&&(localStorage[a]="a"===localStorage[a]?"b":"a")},y.prototype.notify=function(a){this.emit(a),this.notifyLocalWindows(a)};var Nd;Nd="function"==typeof Object.assign?Object.assign:function(a){for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(null!=d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b};var Od=Nd;Dd(D,Error),D.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var Pd=(new D(401,"unauthorized","Name or password is incorrect."),new D(400,"bad_request","Missing JSON list of 'docs'")),Qd=new D(404,"not_found","missing"),Rd=new D(409,"conflict","Document update conflict"),Sd=new D(400,"bad_request","_id field must contain a string"),Td=new D(412,"missing_id","_id is required for puts"),Ud=new D(400,"bad_request","Only reserved document ids may start with underscore."),Vd=(new D(412,"precondition_failed","Database not open"),new D(500,"unknown_error","Database encountered an unknown error")),Wd=new D(500,"badarg","Some query argument is invalid"),Xd=(new D(400,"invalid_request","Request was invalid"),new D(400,"query_parse_error","Some query parameter is invalid")),Yd=new D(500,"doc_validation","Bad special document member"),Zd=new D(400,"bad_request","Something wrong with the request"),$d=new D(400,"bad_request","Document must be a JSON object"),_d=(new D(404,"not_found","Database not found"),new D(500,"indexed_db_went_bad","unknown")),ae=(new D(500,"web_sql_went_bad","unknown"),new D(500,"levelDB_went_went_bad","unknown"),new D(403,"forbidden","Forbidden by design doc validate_doc_update function"),new D(400,"bad_request","Invalid rev format")),be=(new D(412,"file_exists","The database could not be created, the file already exists."),new D(412,"missing_stub","A pre-existing attachment stub wasn't found")),ce=(new D(413,"invalid_url","Provided URL is invalid"),["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]),de="queryKey",ee=/(?:^|&)([^&=]*)=?([^&]*)/g,fe=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ge=function(a){return atob(a)},he=function(a){return btoa(a)},ie=d.setImmediate||d.setTimeout,je=32768,ke=Fd.v4;Dd(Ca,Cd.EventEmitter),Ca.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Ca.prototype.validateChanges=function(a){var b=a.complete,c=this;Qa._changesFilterPlugin?Qa._changesFilterPlugin.validate(a,function(d){if(d)return b(d);c.doChanges(a)}):c.doChanges(a)},Ca.prototype.doChanges=function(a){var b=this,c=a.complete;if(a=j(a),"live"in a&&!("continuous"in a)&&(a.continuous=a.live),a.processChange=Da,"latest"===a.since&&(a.since="now"),a.since||(a.since=0),"now"===a.since)return void this.db.info().then(function(d){if(b.isCancelled)return void c(null,{status:"cancelled"});a.since=d.update_seq,b.doChanges(a)},c);if(Qa._changesFilterPlugin){if(Qa._changesFilterPlugin.normalize(a),Qa._changesFilterPlugin.shouldFilter(this,a))return Qa._changesFilterPlugin.filter(this,a)}else["doc_ids","filter","selector","view"].forEach(function(b){b in a&&z("warn",'The "'+b+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in a||(a.descending=!1),a.limit=0===a.limit?1:a.limit,a.complete=c;var d=this.db._changes(a);if(d&&"function"==typeof d.cancel){var e=b.cancel;b.cancel=Ad(function(a){d.cancel(),e.apply(this,a)})}},Dd(Ma,Cd.EventEmitter),Ma.prototype.post=n("post",function(a,b,c){if("function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a))return c(E($d));this.bulkDocs({docs:[a]},b,Fa(c,a._id))}),Ma.prototype.put=n("put",function(a,b,c){function d(c){"function"==typeof e._put&&!1!==b.new_edits?e._put(a,b,c):e.bulkDocs({docs:[a]},b,Fa(c,a._id))}if("function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a))return c(E($d));if(J(a._id),za(a._id)&&"function"==typeof this._putLocal)return a._deleted?this._removeLocal(a,c):this._putLocal(a,c);var e=this;b.force&&a._rev?(!function(){var c=a._rev.split("-"),d=c[1],e=parseInt(c[0],10),f=e+1,g=fa();a._revisions={start:f,ids:[g,d]},a._rev=f+"-"+g,b.new_edits=!1}(),d(function(b){var d=b?null:{ok:!0,id:a._id,rev:a._rev};c(b,d)})):d(c)}),Ma.prototype.putAttachment=n("putAttachment",function(a,b,c,d,e){function f(a){var c="_rev"in a?parseInt(a._rev,10):0;return a._attachments=a._attachments||{},a._attachments[b]={content_type:e,data:d,revpos:++c},g.put(a)}var g=this;return"function"==typeof e&&(e=d,d=c,c=null),void 0===e&&(e=d,d=c,c=null),e||z("warn","Attachment",b,"on document",a,"is missing content_type"),g.get(a).then(function(a){if(a._rev!==c)throw E(Rd);return f(a)},function(b){if(b.reason===Qd.message)return f({_id:a});throw b})}),Ma.prototype.removeAttachment=n("removeAttachment",function(a,b,c,d){var e=this;e.get(a,function(a,f){return a?void d(a):f._rev!==c?void d(E(Rd)):f._attachments?(delete f._attachments[b],0===Object.keys(f._attachments).length&&delete f._attachments,void e.put(f,d)):d()})}),Ma.prototype.remove=n("remove",function(a,b,c,d){var e;"string"==typeof b?(e={_id:a,_rev:b},"function"==typeof c&&(d=c,c={})):(e=a,"function"==typeof b?(d=b,c={}):(d=c,c=b)),c=c||{},c.was_delete=!0;var f={_id:e._id,_rev:e._rev||c.rev};if(f._deleted=!0,za(f._id)&&"function"==typeof this._removeLocal)return this._removeLocal(e,d);this.bulkDocs({docs:[f]},c,Fa(d,f._id))}),Ma.prototype.revsDiff=n("revsDiff",function(a,b,c){function d(a,b){h.has(a)||h.set(a,{missing:[]}),h.get(a).missing.push(b)}function e(b,c){var e=a[b].slice(0);ha(c,function(a,c,f,g,h){var i=c+"-"+f,j=e.indexOf(i);-1!==j&&(e.splice(j,1),"available"!==h.status&&d(b,i))}),e.forEach(function(a){d(b,a)})}"function"==typeof b&&(c=b,b={});var f=Object.keys(a);if(!f.length)return c(null,{});var g=0,h=new Kd;f.map(function(b){this._getRevisionTree(b,function(d,i){if(d&&404===d.status&&"missing"===d.message)h.set(b,{missing:a[b]});else{if(d)return c(d);e(b,i)}if(++g===f.length){var j={};return h.forEach(function(a,b){j[b]=a}),c(null,j)}})},this)}),Ma.prototype.bulkGet=n("bulkGet",function(a,b){v(this,a,b)}),Ma.prototype.compactDocument=n("compactDocument",function(a,b,c){var d=this;this._getRevisionTree(a,function(e,f){if(e)return c(e);var g=Ia(f),h=[],i=[];Object.keys(g).forEach(function(a){g[a]>b&&h.push(a)}),ha(f,function(a,b,c,d,e){var f=b+"-"+c;"available"===e.status&&-1!==h.indexOf(f)&&i.push(f)}),d._doCompaction(a,i,c)})}),Ma.prototype.compact=n("compact",function(a,b){"function"==typeof a&&(b=a,a={});var c=this;a=a||{},c._compactionQueue=c._compactionQueue||[],c._compactionQueue.push({opts:a,callback:b}),1===c._compactionQueue.length&&Ka(c)}),Ma.prototype._compact=function(a,b){function c(a){g.push(e.compactDocument(a.id,0))}function d(a){var c=a.last_seq;Promise.all(g).then(function(){return Q(e,"_local/compaction",function(a){return(!a.last_seq||a.last_seq<c)&&(a.last_seq=c,a)})}).then(function(){b(null,{ok:!0})}).catch(b)}var e=this,f={return_docs:!1,last_seq:a.last_seq||0},g=[];e.changes(f).on("change",c).on("complete",d).on("error",b)},Ma.prototype.get=n("get",function(a,b,c){function d(){var d=[],g=e.length;if(!g)return c(null,d);e.forEach(function(e){f.get(a,{rev:e,revs:b.revs,latest:b.latest,attachments:b.attachments,binary:b.binary},function(a,b){if(a)d.push({missing:e});else{for(var f,h=0,i=d.length;h<i;h++)if(d[h].ok&&d[h].ok._rev===b._rev){f=!0;break}f||d.push({ok:b})}--g||c(null,d)})})}if("function"==typeof b&&(c=b,b={}),"string"!=typeof a)return c(E(Sd));if(za(a)&&"function"==typeof this._getLocal)return this._getLocal(a,c);var e=[],f=this;if(!b.open_revs)return this._get(a,b,function(d,e){if(d)return d.docId=a,c(d);var g=e.doc,h=e.metadata,i=e.ctx;if(b.conflicts){var j=ka(h);j.length&&(g._conflicts=j)}if(ya(h,g._rev)&&(g._deleted=!0),b.revs||b.revs_info){for(var k=g._rev.split("-"),l=parseInt(k[0],10),m=k[1],n=ma(h.rev_tree),o=null,p=0;p<n.length;p++){var q=n[p],r=q.ids.map(function(a){return a.id}).indexOf(m);(r===l-1||!o&&-1!==r)&&(o=q)}var s=o.ids.map(function(a){return a.id}).indexOf(g._rev.split("-")[1])+1,t=o.ids.length-s;if(o.ids.splice(s,t),o.ids.reverse(),b.revs&&(g._revisions={start:o.pos+o.ids.length-1,ids:o.ids.map(function(a){return a.id})}),b.revs_info){var u=o.pos+o.ids.length;g._revs_info=o.ids.map(function(a){return u--,{rev:u+"-"+a.id,status:a.opts.status}})}}if(b.attachments&&g._attachments){var v=g._attachments,w=Object.keys(v).length;if(0===w)return c(null,g);Object.keys(v).forEach(function(a){this._getAttachment(g._id,a,v[a],{rev:g._rev,binary:b.binary,ctx:i},function(b,d){var e=g._attachments[a];e.data=d,delete e.stub,delete e.length,--w||c(null,g)})},f)}else{if(g._attachments)for(var x in g._attachments)g._attachments.hasOwnProperty(x)&&(g._attachments[x].stub=!0);c(null,g)}});if("all"===b.open_revs)this._getRevisionTree(a,function(a,b){if(a)return c(a);e=ja(b).map(function(a){return a.rev}),d()});else{if(!Array.isArray(b.open_revs))return c(E(Vd,"function_clause"));e=b.open_revs;for(var g=0;g<e.length;g++){var h=e[g];if("string"!=typeof h||!/^\d+-/.test(h))return c(E(ae))}d()}}),Ma.prototype.getAttachment=n("getAttachment",function(a,b,c,d){var e=this;c instanceof Function&&(d=c,c={}),this._get(a,c,function(f,g){return f?d(f):g.doc._attachments&&g.doc._attachments[b]?(c.ctx=g.ctx,c.binary=!0,e._getAttachment(a,b,g.doc._attachments[b],c,d),void 0):d(E(Qd))})}),Ma.prototype.allDocs=n("allDocs",function(a,b){if("function"==typeof a&&(b=a,a={}),a.skip=void 0!==a.skip?a.skip:0,a.start_key&&(a.startkey=a.start_key),a.end_key&&(a.endkey=a.end_key),"keys"in a){if(!Array.isArray(a.keys))return b(new TypeError("options.keys must be an array"));var c=["startkey","endkey","key"].filter(function(b){return b in a})[0];if(c)return void b(E(Xd,"Query parameter `"+c+"` is not compatible with multi-get"));if(!K(this)&&(Ja(a),0===a.keys.length))return this._allDocs({limit:0},b)}return this._allDocs(a,b)}),Ma.prototype.changes=function(a,b){return"function"==typeof a&&(b=a,a={}),a=a||{},a.return_docs="return_docs"in a?a.return_docs:!a.live,new Ca(this,a,b)},Ma.prototype.close=n("close",function(a){return this._closed=!0,this.emit("closed"),this._close(a)}),Ma.prototype.info=n("info",function(a){var b=this;this._info(function(c,d){if(c)return a(c);d.db_name=d.db_name||b.name,d.auto_compaction=!(!b.auto_compaction||K(b)),d.adapter=b.adapter,a(null,d)})}),Ma.prototype.id=n("id",function(a){return this._id(a)}),Ma.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},Ma.prototype.bulkDocs=n("bulkDocs",function(a,b,c){if("function"==typeof b&&(c=b,b={}),b=b||{},Array.isArray(a)&&(a={docs:a}),!a||!a.docs||!Array.isArray(a.docs))return c(E(Pd));for(var d=0;d<a.docs.length;++d)if("object"!=typeof a.docs[d]||Array.isArray(a.docs[d]))return c(E($d));var e;if(a.docs.forEach(function(a){a._attachments&&Object.keys(a._attachments).forEach(function(b){e=e||La(b),a._attachments[b].content_type||z("warn","Attachment",b,"on document",a._id,"is missing content_type")})}),e)return c(E(Zd,e));"new_edits"in b||(b.new_edits=!("new_edits"in a)||a.new_edits);var f=this;b.new_edits||K(f)||a.docs.sort(Ha),Ga(a.docs);var g=a.docs.map(function(a){return a._id});return this._bulkDocs(a,b,function(a,d){if(a)return c(a);if(b.new_edits||(d=d.filter(function(a){return a.error})),!K(f))for(var e=0,h=d.length;e<h;e++)d[e].id=d[e].id||g[e];c(null,d)})}),Ma.prototype.registerDependentDatabase=n("registerDependentDatabase",function(a,b){function c(b){return b.dependentDbs=b.dependentDbs||{},!b.dependentDbs[a]&&(b.dependentDbs[a]=!0,b)}var d=new this.constructor(a,this.__opts);Q(this,"_local/_pouch_dependentDbs",c).then(function(){b(null,{db:d})}).catch(b)}),Ma.prototype.destroy=n("destroy",function(a,b){function c(){d._destroy(a,function(a,c){if(a)return b(a);d._destroyed=!0,d.emit("destroyed"),b(null,c||{ok:!0})})}"function"==typeof a&&(b=a,a={});var d=this,e=!("use_prefix"in d)||d.use_prefix;if(K(d))return c();d.get("_local/_pouch_dependentDbs",function(a,f){if(a)return 404!==a.status?b(a):c();var g=f.dependentDbs,h=d.constructor,i=Object.keys(g).map(function(a){var b=e?a.replace(new RegExp("^"+h.prefix),""):a;return new h(b,d.__opts).destroy()});Promise.all(i).then(c,b)})}),Na.prototype.execute=function(){var a;if(this.failed)for(;a=this.queue.shift();)a(this.failed);else for(;a=this.queue.shift();)a()},Na.prototype.fail=function(a){this.failed=a,this.execute()},Na.prototype.ready=function(a){this.isReady=!0,this.db=a,this.execute()},Na.prototype.addTask=function(a){this.queue.push(a),this.failed&&this.execute()},Dd(Qa,Ma);var le="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},me=fetch,ne=Headers;Qa.adapters={},Qa.preferredAdapters=[],Qa.prefix="_pouch_";var oe=new Cd.EventEmitter;!function(a){Object.keys(Cd.EventEmitter.prototype).forEach(function(b){"function"==typeof Cd.EventEmitter.prototype[b]&&(a[b]=oe[b].bind(oe))});var b=a._destructionListeners=new Kd;a.on("ref",function(a){b.has(a.name)||b.set(a.name,[]),b.get(a.name).push(a)}),a.on("unref",function(a){if(b.has(a.name)){var c=b.get(a.name),d=c.indexOf(a);d<0||(c.splice(d,1),c.length>1?b.set(a.name,c):b.delete(a.name))}}),a.on("destroyed",function(a){if(b.has(a)){var c=b.get(a);b.delete(a),c.forEach(function(a){a.emit("destroyed",!0)})}})}(Qa),Qa.adapter=function(a,b,c){b.valid()&&(Qa.adapters[a]=b,c&&Qa.preferredAdapters.push(a))},Qa.plugin=function(a){if("function"==typeof a)a(Qa);else{if("object"!=typeof a||0===Object.keys(a).length)throw new Error('Invalid plugin: got "'+a+'", expected an object or a function');Object.keys(a).forEach(function(b){Qa.prototype[b]=a[b]})}return this.__defaults&&(Qa.__defaults=Od({},this.__defaults)),Qa},Qa.defaults=function(a){function b(a,c){if(!(this instanceof b))return new b(a,c);c=c||{},a&&"object"==typeof a&&(c=a,a=c.name,delete c.name),c=Od({},b.__defaults,c),Qa.call(this,a,c)}return Dd(b,Qa),b.preferredAdapters=Qa.preferredAdapters.slice(),Object.keys(Qa).forEach(function(a){a in b||(b[a]=Qa[a])}),b.__defaults=Od({},this.__defaults,a),b},Qa.fetch=function(a,b){return me(a,b)}
;var pe=["$or","$nor","$not"],qe=-324,re=3,se="",te={$elemMatch:function(a,b,c,d){return!!Array.isArray(d)&&(0!==d.length&&("object"==typeof d[0]?d.some(function(a){return rb(a,b,Object.keys(b))}):d.some(function(d){return sb(b,a,c,d)})))},$allMatch:function(a,b,c,d){return!!Array.isArray(d)&&(0!==d.length&&("object"==typeof d[0]?d.every(function(a){return rb(a,b,Object.keys(b))}):d.every(function(d){return sb(b,a,c,d)})))},$eq:function(a,b,c,d){return wb(d)&&0===db(d,b)},$gte:function(a,b,c,d){return wb(d)&&db(d,b)>=0},$gt:function(a,b,c,d){return wb(d)&&db(d,b)>0},$lte:function(a,b,c,d){return wb(d)&&db(d,b)<=0},$lt:function(a,b,c,d){return wb(d)&&db(d,b)<0},$exists:function(a,b,c,d){return b?wb(d):!wb(d)},$mod:function(a,b,c,d){return vb(d)&&xb(d,b)},$ne:function(a,b,c,d){return b.every(function(a){return 0!==db(d,a)})},$in:function(a,b,c,d){return vb(d)&&yb(d,b)},$nin:function(a,b,c,d){return vb(d)&&!yb(d,b)},$size:function(a,b,c,d){return vb(d)&&Ab(d,b)},$all:function(a,b,c,d){return Array.isArray(d)&&zb(d,b)},$regex:function(a,b,c,d){return vb(d)&&Bb(d,b)},$type:function(a,b,c,d){return Cb(d,b)}};Qa.plugin(Kb),Qa.version="7.0.0";var ue,ve=Lb(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),we=Lb(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),xe=5,ye="document-store",ze="by-sequence",Ae="attach-store",Be="attach-seq-store",Ce="meta-store",De="local-store",Ee="detect-blob-support",Fe=new y,Ge=!1,He=[],Ie=new Kd,Je=new Kd;sc.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(a){return!1}};var Ke=25,Le=50,Me=5e3,Ne=1e4,Oe={};Fc.valid=function(){return!0},Dd(Hc,Error),Dd(Ic,Error),Dd(Jc,Error);var Pe=z.bind(null,"log"),Qe=Array.isArray,Re=JSON.parse;Tc.prototype.add=function(a){return this.promise=this.promise.catch(function(){}).then(function(){return a()}),this.promise},Tc.prototype.finish=function(){return this.promise};var Se={},Te=new Tc,Ue=50,Ve={_sum:function(a,b){return Rc(b)},_count:function(a,b){return b.length},_stats:function(a,b){return{sum:Rc(b),min:Math.min.apply(null,b),max:Math.max.apply(null,b),count:b.length,sumsqr:function(a){for(var b=0,c=0,d=a.length;c<d;c++){var e=a[c];b+=e*e}return b}(b)}}},We=function(a,b,c,d){function e(a,b,c){try{b(c)}catch(b){Zc(a,b)}}function f(a,b,c,d,e){try{return{output:b(c,d,e)}}catch(b){return Zc(a,b),{error:b}}}function g(a,b){var c=db(a.key,b.key);return 0!==c?c:db(a.value,b.value)}function h(a,b,c){return c=c||0,"number"==typeof b?a.slice(c,b+c):c>0?a.slice(c):a}function i(a){var b=a.value;return b&&"object"==typeof b&&b._id||a.id}function j(a){a.rows.forEach(function(a){var b=a.doc&&a.doc._attachments;b&&Object.keys(b).forEach(function(a){var c=b[a];b[a].data=V(c.data,c.content_type)})})}function k(a){return function(b){return a.include_docs&&a.attachments&&a.binary&&j(b),b}}function l(a,b,c,d){var e=b[a];void 0!==e&&(d&&(e=encodeURIComponent(JSON.stringify(e))),c.push(a+"="+e))}function m(a){if(void 0!==a){var b=Number(a);return isNaN(b)||b!==parseInt(a,10)?a:b}}function n(a){return a.group_level=m(a.group_level),a.limit=m(a.limit),a.skip=m(a.skip),a}function o(a){if(a){if("number"!=typeof a)return new Hc('Invalid value for integer: "'+a+'"');if(a<0)return new Hc('Invalid value for positive integer: "'+a+'"')}}function p(a,b){var c=a.descending?"endkey":"startkey",d=a.descending?"startkey":"endkey";if(void 0!==a[c]&&void 0!==a[d]&&db(a[c],a[d])>0)throw new Hc("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(b.reduce&&!1!==a.reduce){if(a.include_docs)throw new Hc("{include_docs:true} is invalid for reduce");if(a.keys&&a.keys.length>1&&!a.group&&!a.group_level)throw new Hc("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(b){var c=o(a[b]);if(c)throw c})}function q(a,b,c){var d,e,f,g=[],h="GET";if(l("reduce",c,g),l("include_docs",c,g),l("attachments",c,g),l("limit",c,g),l("descending",c,g),l("group",c,g),l("group_level",c,g),l("skip",c,g),l("stale",c,g),l("conflicts",c,g),l("startkey",c,g,!0),l("start_key",c,g,!0),l("endkey",c,g,!0),l("end_key",c,g,!0),l("inclusive_end",c,g),l("key",c,g,!0),l("update_seq",c,g),g=g.join("&"),g=""===g?"":"?"+g,void 0!==c.keys){var i="keys="+encodeURIComponent(JSON.stringify(c.keys));i.length+g.length+1<=2e3?g+=("?"===g[0]?"&":"?")+i:(h="POST","string"==typeof b?d={keys:c.keys}:b.keys=c.keys)}if("string"==typeof b){var j=Xc(b);return a.fetch("_design/"+j[0]+"/_view/"+j[1]+g,{headers:new ne({"Content-Type":"application/json"}),method:h,body:JSON.stringify(d)}).then(function(a){return e=a.ok,f=a.status,a.json()}).then(function(a){if(!e)throw a.status=f,F(a);return a.rows.forEach(function(a){if(a.value&&a.value.error&&"builtin_reduce_error"===a.value.error)throw new Error(a.reason)}),a}).then(k(c))}return d=d||{},Object.keys(b).forEach(function(a){Array.isArray(b[a])?d[a]=b[a]:d[a]=b[a].toString()}),a.fetch("_temp_view"+g,{headers:new ne({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(d)}).then(function(a){return e=a.ok,f=a.status,a.json()}).then(function(a){if(!e)throw a.status=f,F(a);return a}).then(k(c))}function r(a,b,c){return new Promise(function(d,e){a._query(b,c,function(a,b){if(a)return e(a);d(b)})})}function s(a){return new Promise(function(b,c){a._viewCleanup(function(a,d){if(a)return c(a);b(d)})})}function t(a){return function(b){if(404===b.status)return a;throw b}}function u(a,b,c){function d(a){return a.keys.length?b.db.allDocs({keys:a.keys,include_docs:!0}):Promise.resolve({rows:[]})}function e(a,b){for(var c=[],d=new Jd,e=0,f=b.rows.length;e<f;e++){var g=b.rows[e],h=g.doc;if(h&&(c.push(h),d.add(h._id),h._deleted=!i.has(h._id),!h._deleted)){var j=i.get(h._id);"value"in j&&(h.value=j.value)}}var k=Pc(i);return k.forEach(function(a){if(!d.has(a)){var b={_id:a},e=i.get(a);"value"in e&&(b.value=e.value),c.push(b)}}),a.keys=Oc(k.concat(a.keys)),c.push(a),c}var f="_local/doc_"+a,g={_id:f,keys:[]},h=c.get(a),i=h[0],j=h[1];return function(){return Yc(j)?Promise.resolve(g):b.db.get(f).catch(t(g))}().then(function(a){return d(a).then(function(b){return e(a,b)})})}function v(a,b,c){return a.db.get("_local/lastSeq").catch(t({_id:"_local/lastSeq",seq:0})).then(function(d){var e=Pc(b);return Promise.all(e.map(function(c){return u(c,a,b)})).then(function(b){var e=I(b);return d.seq=c,e.push(d),a.db.bulkDocs({docs:e})})})}function w(a){var b="string"==typeof a?a:a.name,c=Se[b];return c||(c=Se[b]=new Tc),c}function x(a){return Nc(w(a),function(){return y(a)})()}function y(a){function c(a,b){var c={id:l._id,key:eb(a)};void 0!==b&&null!==b&&(c.value=eb(b)),k.push(c)}function d(b,c){return function(){return v(a,b,c)}}function f(){return a.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:n,limit:Ue}).then(h)}function h(a){var b=a.results;if(b.length){var c=i(b);if(o.add(d(c,n)),!(b.length<Ue))return f()}}function i(b){for(var c=new Kd,d=0,f=b.length;d<f;d++){var h=b[d];if("_"!==h.doc._id[0]){k=[],l=h.doc,l._deleted||e(a.sourceDB,m,l),k.sort(g);var i=j(k);c.set(h.doc._id,[i,h.changes])}n=h.seq}return c}function j(a){for(var b,c=new Kd,d=0,e=a.length;d<e;d++){var f=a[d],g=[f.key,f.id];d>0&&0===db(f.key,b)&&g.push(d),c.set(gb(g),f),b=f.key}return c}var k,l,m=b(a.mapFun,c),n=a.seq||0,o=new Tc;return f().then(function(){return o.finish()}).then(function(){a.seq=n})}function z(a,b,d){0===d.group_level&&delete d.group_level;var e=d.group||d.group_level,g=c(a.reduceFun),i=[],j=isNaN(d.group_level)?Number.POSITIVE_INFINITY:d.group_level;b.forEach(function(a){var b=i[i.length-1],c=e?a.key:null;if(e&&Array.isArray(c)&&(c=c.slice(0,j)),b&&0===db(b.groupKey,c))return b.keys.push([a.key,a.id]),void b.values.push(a.value);i.push({keys:[[a.key,a.id]],values:[a.value],groupKey:c})}),b=[];for(var k=0,l=i.length;k<l;k++){var m=i[k],n=f(a.sourceDB,g,m.keys,m.values,!1);if(n.error&&n.error instanceof Jc)throw n.error;b.push({value:n.error?null:n.output,key:m.groupKey})}return{rows:h(b,d.limit,d.skip)}}function A(a,b){return Nc(w(a),function(){return B(a,b)})()}function B(a,b){function c(b){return b.include_docs=!0,a.db.allDocs(b).then(function(a){return e=a.total_rows,a.rows.map(function(a){if("value"in a.doc&&"object"==typeof a.doc.value&&null!==a.doc.value){var b=Object.keys(a.doc.value).sort(),c=["id","key","value"];if(!(b<c||b>c))return a.doc.value}var d=jb(a.doc._id);return{key:d[0],id:d[1],value:"value"in a.doc?a.doc.value:null}})})}function d(c){var d;if(d=f?z(a,c,b):{total_rows:e,offset:g,rows:c},b.update_seq&&(d.update_seq=a.seq),b.include_docs){var h=Oc(c.map(i));return a.sourceDB.allDocs({keys:h,include_docs:!0,conflicts:b.conflicts,attachments:b.attachments,binary:b.binary}).then(function(a){var b=new Kd;return a.rows.forEach(function(a){b.set(a.id,a.doc)}),c.forEach(function(a){var c=i(a),d=b.get(c);d&&(a.doc=d)}),d})}return d}var e,f=a.reduceFun&&!1!==b.reduce,g=b.skip||0;if(void 0===b.keys||b.keys.length||(b.limit=0,delete b.keys),void 0!==b.keys){var h=b.keys,j=h.map(function(a){var d={startkey:gb([a]),endkey:gb([a,{}])};return b.update_seq&&(d.update_seq=!0),c(d)});return Promise.all(j).then(I).then(d)}var k={descending:b.descending};b.update_seq&&(k.update_seq=!0);var l,m;if("start_key"in b&&(l=b.start_key),"startkey"in b&&(l=b.startkey),"end_key"in b&&(m=b.end_key),"endkey"in b&&(m=b.endkey),void 0!==l&&(k.startkey=gb(b.descending?[l,{}]:[l])),void 0!==m){var n=!1!==b.inclusive_end;b.descending&&(n=!n),k.endkey=gb(n?[m,{}]:[m])}if(void 0!==b.key){var o=gb([b.key]),p=gb([b.key,{}]);k.descending?(k.endkey=o,k.startkey=p):(k.startkey=o,k.endkey=p)}return f||("number"==typeof b.limit&&(k.limit=b.limit),k.skip=g),c(k).then(d)}function C(a){return a.fetch("_view_cleanup",{headers:new ne({"Content-Type":"application/json"}),method:"POST"}).then(function(a){return a.json()})}function D(b){return b.get("_local/"+a).then(function(a){var c=new Kd;Object.keys(a.views).forEach(function(a){var b=Xc(a),d="_design/"+b[0],e=b[1],f=c.get(d);f||(f=new Jd,c.set(d,f)),f.add(e)});var d={keys:Pc(c),include_docs:!0};return b.allDocs(d).then(function(d){var e={};d.rows.forEach(function(b){var d=b.key.substring(8);c.get(b.key).forEach(function(c){var f=d+"/"+c;a.views[f]||(f=c);var g=Object.keys(a.views[f]),h=b.doc&&b.doc.views&&b.doc.views[c];g.forEach(function(a){e[a]=e[a]||h})})});var f=Object.keys(e).filter(function(a){return!e[a]}),g=f.map(function(a){return Nc(w(a),function(){return new b.constructor(a,b.__opts).destroy()})()});return Promise.all(g).then(function(){return{ok:!0}})})},t({ok:!0}))}function E(b,c,e){if("function"==typeof b._query)return r(b,c,e);if(K(b))return q(b,c,e);if("string"!=typeof c)return p(e,c),Te.add(function(){return Wc(b,"temp_view/temp_view",c.map,c.reduce,!0,a).then(function(a){return Mc(x(a).then(function(){return A(a,e)}),function(){return a.db.destroy()})})}),Te.finish();var f=c,g=Xc(f),h=g[0],i=g[1];return b.get("_design/"+h).then(function(c){var g=c.views&&c.views[i];if(!g)throw new Ic("ddoc "+c._id+" has no view named "+i);return d(c,i),p(e,g),Wc(b,f,g.map,g.reduce,!1,a).then(function(a){return"ok"===e.stale||"update_after"===e.stale?("update_after"===e.stale&&Bd(function(){x(a)}),A(a,e)):x(a).then(function(){return A(a,e)})})})}function G(a,b,c){var d=this;"function"==typeof b&&(c=b,b={}),b=b?n(b):{},"function"==typeof a&&(a={map:a});var e=Promise.resolve().then(function(){return E(d,a,b)});return Kc(e,c),e}return{query:G,viewCleanup:Lc(function(){var a=this;return"function"==typeof a._viewCleanup?s(a):K(a)?C(a):D(a)})}}("mrviews",_c,ad,bd),Xe={query:cd,viewCleanup:dd},Ye=1,Ze="pouchdb",$e=5,_e=0;ld.prototype.writeCheckpoint=function(a,b){var c=this;return this.updateTarget(a,b).then(function(){return c.updateSource(a,b)})},ld.prototype.updateTarget=function(a,b){return this.opts.writeTargetCheckpoint?kd(this.target,this.id,a,b,this.returnValue):Promise.resolve(!0)},ld.prototype.updateSource=function(a,b){if(this.opts.writeSourceCheckpoint){var c=this;return kd(this.src,this.id,a,b,this.returnValue).catch(function(a){if(pd(a))return c.opts.writeSourceCheckpoint=!1,!0;throw a})}return Promise.resolve(!0)};var af={undefined:function(a,b){return 0===db(a.last_seq,b.last_seq)?b.last_seq:0},1:function(a,b){return md(b,a).last_seq}};ld.prototype.getCheckpoint=function(){var a=this;return a.opts&&a.opts.writeSourceCheckpoint&&!a.opts.writeTargetCheckpoint?a.src.get(a.id).then(function(a){return a.last_seq||_e}).catch(function(a){if(404!==a.status)throw a;return _e}):a.target.get(a.id).then(function(b){return a.opts&&a.opts.writeTargetCheckpoint&&!a.opts.writeSourceCheckpoint?b.last_seq||_e:a.src.get(a.id).then(function(a){if(b.version!==a.version)return _e;var c;return c=b.version?b.version.toString():"undefined",c in af?af[c](b,a):_e},function(c){if(404===c.status&&b.last_seq)return a.src.put({_id:a.id,last_seq:_e}).then(function(){return _e},function(c){return pd(c)?(a.opts.writeSourceCheckpoint=!1,b.last_seq):_e});throw c})}).catch(function(a){if(404!==a.status)throw a;return _e})};var bf=0;Dd(ud,Cd.EventEmitter),ud.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},ud.prototype.ready=function(a,b){function c(){e.cancel()}function d(){a.removeListener("destroyed",c),b.removeListener("destroyed",c)}var e=this;e._readyCalled||(e._readyCalled=!0,a.once("destroyed",c),b.once("destroyed",c),e.once("complete",d))},Dd(yd,Cd.EventEmitter),yd.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},Qa.plugin(uc).plugin(Gc).plugin(Xe).plugin(zd),b.exports=Qa}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:6,argsarray:1,events:2,immediate:3,inherits:4,"spark-md5":7,uuid:8,vuvuzela:13}],6:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.prependListener=k,n.prependOnceListener=k,n.listeners=function(a){return[]},n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],7:[function(b,c,d){!function(b){if("object"==typeof d)c.exports=b();else if("function"==typeof a&&a.amd)a(b);else{var e;try{e=window}catch(a){e=self}e.SparkMD5=b()}}(function(a){"use strict";function b(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-680876936|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[1]-389564586|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[2]+606105819|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[3]-1044525330|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[4]-176418897|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[5]+1200080426|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[6]-1473231341|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[7]-45705983|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[8]+1770035416|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[9]-1958414417|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[10]-42063|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[11]-1990404162|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[12]+1804603682|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[13]-40341101|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[14]-1502002290|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[15]+1236535329|0,d=(d<<22|d>>>10)+e|0,c+=(d&f|e&~f)+b[1]-165796510|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[6]-1069501632|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[11]+643717713|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[0]-373897302|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[5]-701558691|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[10]+38016083|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[15]-660478335|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[4]-405537848|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[9]+568446438|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[14]-1019803690|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[3]-187363961|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[8]+1163531501|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[13]-1444681467|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[2]-51403784|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[7]+1735328473|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[12]-1926607734|0,d=(d<<20|d>>>12)+e|0,c+=(d^e^f)+b[5]-378558|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[8]-2022574463|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[11]+1839030562|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[14]-35309556|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[1]-1530992060|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[4]+1272893353|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[7]-155497632|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[10]-1094730640|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[13]+681279174|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[0]-358537222|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[3]-722521979|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[6]+76029189|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[9]-640364487|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[12]-421815835|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[15]+530742520|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[2]-995338651|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-198630844|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+1126891415|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-1416354905|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-57434055|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+1700485571|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-1894986606|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-2054922799|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+1873313359|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-30611744|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-1560198380|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+1309151649|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-145523070|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-1120210379|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+718787259|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-343485551|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}function c(a){var b,c=[];for(b=0;b<64;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function d(a){var b,c=[];for(b=0;b<64;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c}function e(a){var d,e,f,g,h,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(d=64;d<=j;d+=64)b(k,c(a.substring(d-64,d)));for(a=a.substring(d-64),e=a.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=0;d<e;d+=1)f[d>>2]|=a.charCodeAt(d)<<(d%4<<3);if(f[d>>2]|=128<<(d%4<<3),d>55)for(b(k,f),d=0;d<16;d+=1)f[d]=0;return g=8*j,g=g.toString(16).match(/(.*?)(.{0,8})$/),h=parseInt(g[2],16),i=parseInt(g[1],16)||0,f[14]=h,f[15]=i,b(k,f),k}function f(a){var c,e,f,g,h,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(c=64;c<=j;c+=64)b(k,d(a.subarray(c-64,c)));for(a=c-64<j?a.subarray(c-64):new Uint8Array(0),e=a.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0;c<e;c+=1)f[c>>2]|=a[c]<<(c%4<<3);if(f[c>>2]|=128<<(c%4<<3),c>55)for(b(k,f),c=0;c<16;c+=1)f[c]=0;return g=8*j,g=g.toString(16).match(/(.*?)(.{0,8})$/),h=parseInt(g[2],16),i=parseInt(g[1],16)||0,f[14]=h,f[15]=i,b(k,f),k}function g(a){var b,c="";for(b=0;b<4;b+=1)c+=o[a>>8*b+4&15]+o[a>>8*b&15];return c}function h(a){var b;for(b=0;b<a.length;b+=1)a[b]=g(a[b]);return a.join("")}function i(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}function j(a,b){var c,d=a.length,e=new ArrayBuffer(d),f=new Uint8Array(e);for(c=0;c<d;c+=1)f[c]=a.charCodeAt(c);return b?f:e}function k(a){return String.fromCharCode.apply(null,new Uint8Array(a))}function l(a,b,c){var d=new Uint8Array(a.byteLength+b.byteLength);return d.set(new Uint8Array(a)),d.set(new Uint8Array(b),a.byteLength),c?d:d.buffer}function m(a){var b,c=[],d=a.length;for(b=0;b<d-1;b+=2)c.push(parseInt(a.substr(b,2),16));return String.fromCharCode.apply(String,c)}function n(){this.reset()}var o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==h(e("hello"))&&function(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function b(a,b){return a=0|a||0,a<0?Math.max(a+b,0):Math.min(a,b)}ArrayBuffer.prototype.slice=function(c,d){var e,f,g,h,i=this.byteLength,j=b(c,i),k=i;return d!==a&&(k=b(d,i)),j>k?new ArrayBuffer(0):(e=k-j,f=new ArrayBuffer(e),g=new Uint8Array(f),h=new Uint8Array(this,j,e),g.set(h),f)}}(),n.prototype.append=function(a){return this.appendBinary(i(a)),this},n.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var d,e=this._buff.length;for(d=64;d<=e;d+=64)b(this._hash,c(this._buff.substring(d-64,d)));return this._buff=this._buff.substring(d-64),this},n.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<e;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=h(this._hash),a&&(c=m(c)),this.reset(),c},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},n.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(a,c){var d,e,f,g=c;if(a[g>>2]|=128<<(g%4<<3),g>55)for(b(this._hash,a),g=0;g<16;g+=1)a[g]=0;d=8*this._length,d=d.toString(16).match(/(.*?)(.{0,8})$/),e=parseInt(d[2],16),f=parseInt(d[1],16)||0,a[14]=e,a[15]=f,b(this._hash,a)},n.hash=function(a,b){return n.hashBinary(i(a),b)},n.hashBinary=function(a,b){var c=e(a),d=h(c);return b?m(d):d},n.ArrayBuffer=function(){this.reset()},n.ArrayBuffer.prototype.append=function(a){var c,e=l(this._buff.buffer,a,!0),f=e.length;for(this._length+=a.byteLength,c=64;c<=f;c+=64)b(this._hash,d(e.subarray(c-64,c)));return this._buff=c-64<f?new Uint8Array(e.buffer.slice(c-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<e;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=h(this._hash),a&&(c=m(c)),this.reset(),c},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var a=n.prototype.getState.call(this);return a.buff=k(a.buff),a},n.ArrayBuffer.prototype.setState=function(a){return a.buff=j(a.buff,!0),n.prototype.setState.call(this,a)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(a,b){var c=f(new Uint8Array(a)),d=h(c);return b?m(d):d},n})},{}],8:[function(a,b,c){var d=a("./v1"),e=a("./v4"),f=e;f.v1=d,f.v4=e,b.exports=f},{"./v1":11,"./v4":12}],9:[function(a,b,c){function d(a,b){var c=b||0,d=e;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}for(var e=[],f=0;f<256;++f)e[f]=(f+256).toString(16).substr(1);b.exports=d},{}],10:[function(a,b,c){var d="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(d){var e=new Uint8Array(16);b.exports=function(){return d(e),e}}else{var f=new Array(16);b.exports=function(){for(var a,b=0;b<16;b++)0==(3&b)&&(a=4294967296*Math.random()),f[b]=a>>>((3&b)<<3)&255;return f}}},{}],11:[function(a,b,c){function d(a,b,c){var d=b&&c||0,k=b||[];a=a||{};var l=a.node||e,m=void 0!==a.clockseq?a.clockseq:f;if(null==l||null==m){var n=g();null==l&&(l=e=[1|n[0],n[1],n[2],n[3],n[4],n[5]]),null==m&&(m=f=16383&(n[6]<<8|n[7]))}var o=void 0!==a.msecs?a.msecs:(new Date).getTime(),p=void 0!==a.nsecs?a.nsecs:j+1,q=o-i+(p-j)/1e4;if(q<0&&void 0===a.clockseq&&(m=m+1&16383),(q<0||o>i)&&void 0===a.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=o,j=p,f=m,o+=122192928e5;var r=(1e4*(268435455&o)+p)%4294967296;k[d++]=r>>>24&255,k[d++]=r>>>16&255,k[d++]=r>>>8&255,k[d++]=255&r;var s=o/4294967296*1e4&268435455;k[d++]=s>>>8&255,k[d++]=255&s,k[d++]=s>>>24&15|16,k[d++]=s>>>16&255,k[d++]=m>>>8|128,k[d++]=255&m;for(var t=0;t<6;++t)k[d+t]=l[t];return b||h(k)}var e,f,g=a("./lib/rng"),h=a("./lib/bytesToUuid"),i=0,j=0;b.exports=d},{"./lib/bytesToUuid":9,"./lib/rng":10}],12:[function(a,b,c){function d(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"===a?new Array(16):null,a=null),a=a||{};var g=a.random||(a.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,b)for(var h=0;h<16;++h)b[d+h]=g[h];return b||f(g)}var e=a("./lib/rng"),f=a("./lib/bytesToUuid");b.exports=d},{"./lib/bytesToUuid":9,"./lib/rng":10}],13:[function(a,b,c){"use strict";function d(a,b,c){var d=c[c.length-1];a===d.element&&(c.pop(),d=c[c.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(a);else if(f===b.length-2){var g=b.pop();e[g]=a}else b.push(a)}c.stringify=function(a){var b=[];b.push({obj:a});for(var c,d,e,f,g,h,i,j,k,l,m,n="";c=b.pop();)if(d=c.obj,e=c.prefix||"",f=c.val||"",n+=e,f)n+=f;else if("object"!=typeof d)n+=void 0===d?null:JSON.stringify(d);else if(null===d)n+="null";else if(Array.isArray(d)){for(b.push({val:"]"}),g=d.length-1;g>=0;g--)h=0===g?"":",",b.push({obj:d[g],prefix:h});b.push({val:"["})}else{i=[];for(j in d)d.hasOwnProperty(j)&&i.push(j);for(b.push({val:"}"}),g=i.length-1;g>=0;g--)k=i[g],l=d[k],m=g>0?",":"",m+=JSON.stringify(k)+":",b.push({obj:l,prefix:m});b.push({val:"{"})}return n},c.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l=[],m=[],n=0;;)if("}"!==(b=a[n++])&&"]"!==b&&void 0!==b)switch(b){case" ":case"\t":case"\n":case":":case",":break;case"n":n+=3,d(null,l,m);break;case"t":n+=3,d(!0,l,m);break;case"f":n+=4,d(!1,l,m);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(c="",n--;;){if(e=a[n++],!/[\d\.\-e\+]/.test(e)){n--;break}c+=e}d(parseFloat(c),l,m);break;case'"':for(f="",g=void 0,h=0;;){if('"'===(i=a[n++])&&("\\"!==g||h%2!=1))break;f+=i,g=i,"\\"===g?h++:h=0}d(JSON.parse('"'+f+'"'),l,m);break;case"[":j={element:[],index:l.length},l.push(j.element),m.push(j);break;case"{":k={element:{},index:l.length},l.push(k.element),m.push(k);break;default:throw new Error("unexpectedly reached end of input: "+b)}else{if(1===l.length)return l.pop();d(l.pop(),l,m)}}},{}]},{},[5])(5)});